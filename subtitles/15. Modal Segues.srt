
ï»¿1
00:00:00,001 --> 00:00:04,536
[MUSIC]

2
00:00:04,538 --> 00:00:07,672
Stanford University.

3
00:00:07,674 --> 00:00:12,409
>> Okay, well, welcome to Lecture 15 of

4
00:00:12,411 --> 00:00:18,114
Stanford CS193P Winter of 2015.

5
00:00:18,116 --> 00:00:21,951
So my topic slide today, I actually have topics for

6
00:00:21,953 --> 00:00:24,353
this whole week, the two days.

7
00:00:24,355 --> 00:00:29,691
This is going to be kinda one continuous demonstration.

8
00:00:29,693 --> 00:00:31,459
Where I'm going to go back to the demonstration,

9
00:00:31,461 --> 00:00:33,561
back to the slides, back to the demonstration.

10
00:00:33,563 --> 00:00:35,263
Although today,

11
00:00:35,264 --> 00:00:36,964
I'm probably only going to cover that first slide point.

12
00:00:36,966 --> 00:00:39,733
And then, I have a demo pretty much the rest of the way.

13
00:00:39,735 --> 00:00:42,035
If I have time left, which hopefully I do,

14
00:00:42,037 --> 00:00:43,936
I will do the slides for the camera.

15
00:00:43,938 --> 00:00:46,906
And then, we can start off on Wednesday with the camera part

16
00:00:46,908 --> 00:00:50,309
of the demo and then move on to the rest of the stuff.

17
00:00:50,311 --> 00:00:51,977
But, it's pretty action-packed.

18
00:00:51,979 --> 00:00:53,144
I have a lot of stuff to cover,

19
00:00:53,146 --> 00:00:55,213
especially in today's demo.

20
00:00:55,215 --> 00:00:57,314
It's gonna be a lot more even than just modal and

21
00:00:57,316 --> 00:00:59,450
popover segues.

22
00:00:59,451 --> 00:01:01,585
I'm gonna talk a little bit more about notifications and

23
00:01:01,587 --> 00:01:03,553
adaptations, things like that.

24
00:01:03,555 --> 00:01:05,221
So there's a lot to cover.

25
00:01:05,223 --> 00:01:08,624
All right so I'm going to dive in here though with modal

26
00:01:08,626 --> 00:01:11,427
view controllers and I intentionally put off

27
00:01:11,429 --> 00:01:15,264
the modal segues until towards the end of the quarter.

28
00:01:15,266 --> 00:01:17,366
Because when people see it early, they're like, oh, wow,

29
00:01:17,368 --> 00:01:18,867
I'm just gonna put everything up modally.

30
00:01:18,869 --> 00:01:21,069
It's just so easy to do a modal segue.

31
00:01:21,071 --> 00:01:22,636
And it is easy to do a modal segue.

32
00:01:22,638 --> 00:01:26,239
But it actually has to be used with care because since it

33
00:01:26,241 --> 00:01:27,874
locks up, you're out,

34
00:01:27,876 --> 00:01:31,411
basically until they deal with what's on-screen.

35
00:01:31,413 --> 00:01:34,847
The users can kinda be a little bit disturbed by modal.

36
00:01:37,184 --> 00:01:39,984
Generally users prefer more free flowing thing where they

37
00:01:39,986 --> 00:01:42,253
can click on something and then move back and

38
00:01:42,255 --> 00:01:44,388
things you know, flow a little better.

39
00:01:44,390 --> 00:01:47,191
But there are sometimes when it just doesn't make sense for

40
00:01:47,193 --> 00:01:49,793
your app to proceed without stopping the user and

41
00:01:49,795 --> 00:01:52,429
making them answer a question.

42
00:01:52,431 --> 00:01:55,565
So modal view controllers is what that's good for.

43
00:01:55,567 --> 00:01:58,668
We've already seen modal view controllers, actually.

44
00:01:58,670 --> 00:02:01,570
The alerts, the whole alert and action sheet thing.

45
00:02:01,572 --> 00:02:03,538
That's nothing more than a UIViewController

46
00:02:03,540 --> 00:02:05,507
that we put up modally.

47
00:02:05,508 --> 00:02:07,475
Notice that it took over the screen, didn't let us do

48
00:02:07,477 --> 00:02:11,145
anything until we responded to the alert of the action seat.

49
00:02:11,147 --> 00:02:13,748
And modal view controllers are just creating your own

50
00:02:13,750 --> 00:02:15,249
things that pop up and

51
00:02:15,251 --> 00:02:17,050
don't let the user proceed until you deal with it.

52
00:02:17,052 --> 00:02:20,754
So here's an example of a modal view controller.

53
00:02:20,756 --> 00:02:23,122
Here, I'm in the contacts app.

54
00:02:23,124 --> 00:02:26,659
And if I tap on that little plus in the corner,

55
00:02:26,661 --> 00:02:29,228
it's gonna put up a modal MVC.

56
00:02:29,230 --> 00:02:32,397
So I'll tap on it, then modal MVC slides up from the bottom.

57
00:02:32,399 --> 00:02:36,501
This is an MVC that lets you add a new contact.

58
00:02:36,503 --> 00:02:38,970
And so that's something that you wanna kinda get it all

59
00:02:38,972 --> 00:02:39,770
the way you want.

60
00:02:39,772 --> 00:02:41,238
And say, okay, add it,

61
00:02:41,240 --> 00:02:44,574
rather than it being kinda partially added all the time.

62
00:02:44,576 --> 00:02:45,942
So that's why they use modal here.

63
00:02:45,944 --> 00:02:47,710
Although, you could probably even think of a way to do this

64
00:02:47,712 --> 00:02:48,310
non-modally.

65
00:02:48,312 --> 00:02:49,745
But it's not bad.

66
00:02:49,747 --> 00:02:52,781
Now notice that there's no back button per se.

67
00:02:52,783 --> 00:02:54,082
But a lot of times where the back

68
00:02:54,084 --> 00:02:56,684
button usually would be is a cancel button, okay.

69
00:02:56,686 --> 00:02:57,852
Which will take them back,

70
00:02:57,854 --> 00:03:00,220
but it will cancel whatever they're doing in this

71
00:03:00,222 --> 00:03:01,889
modal view controller.

72
00:03:01,890 --> 00:03:03,557
And then, often, in the upper right, there is a button,

73
00:03:03,559 --> 00:03:06,359
a done button, or save button, or something like.

74
00:03:06,361 --> 00:03:09,562
That will usually commit the changes in the modal

75
00:03:10,498 --> 00:03:13,065
view controller, and then dismiss it, okay.

76
00:03:13,067 --> 00:03:15,500
Now, this particular modal view controller actually

77
00:03:15,502 --> 00:03:18,169
can put another modal view controller up.

78
00:03:18,171 --> 00:03:19,270
If you look at this button here,

79
00:03:19,272 --> 00:03:20,904
add photo, if you click on it,

80
00:03:20,906 --> 00:03:23,106
it's going to put another modal view controller up.

81
00:03:23,108 --> 00:03:25,108
It slides up from the bottom,

82
00:03:25,110 --> 00:03:27,677
asking you to pick a photo from your photo library here.

83
00:03:27,679 --> 00:03:29,879
I don't have any photos so I couldn't do it.

84
00:03:29,881 --> 00:03:32,648
There's no back button here because you

85
00:03:32,650 --> 00:03:34,516
either pick a photo or you cancel.

86
00:03:34,518 --> 00:03:35,650
Okay, so you don't need a dumb button.

87
00:03:35,652 --> 00:03:38,186
I would have argued that that cancel button,

88
00:03:38,188 --> 00:03:39,887
I kind of feel like should be on the left.

89
00:03:39,889 --> 00:03:42,723
This is an Apple app, so I guess I'm wrong.

90
00:03:42,725 --> 00:03:44,324
But to me I'm always,

91
00:03:44,326 --> 00:03:47,460
kinda looking to the upper left for get me out of here,

92
00:03:47,462 --> 00:03:50,496
get me back to what I was before, but anyway.

93
00:03:50,498 --> 00:03:54,200
So if we do hit that cancel button you can see that this

94
00:03:54,202 --> 00:03:57,369
modal view controller then will dismiss, and

95
00:03:57,371 --> 00:03:58,570
the other one comes back.

96
00:03:58,572 --> 00:03:59,871
And same thing here.

97
00:03:59,873 --> 00:04:02,874
Once we're done in here let's say we Cancel or we hit Done,

98
00:04:02,876 --> 00:04:03,741
either way.

99
00:04:03,743 --> 00:04:05,109
And then, this one will dismiss and

100
00:04:05,111 --> 00:04:06,394
it goes back to where you were.

101
00:04:06,395 --> 00:04:07,678
So that's the way modal view controllers work.

102
00:04:07,680 --> 00:04:10,146
They just take over the screen, you do something and

103
00:04:10,148 --> 00:04:11,781
then when they're done they dismiss.

104
00:04:11,783 --> 00:04:13,149
Now there's a lot of different ways for

105
00:04:13,151 --> 00:04:16,785
modal view controllers to appear on the screen visually.

106
00:04:16,787 --> 00:04:18,820
And we will talk about that.

107
00:04:20,123 --> 00:04:22,890
So as I said, you want to be careful with these.

108
00:04:22,892 --> 00:04:25,059
They do block your UI,

109
00:04:25,061 --> 00:04:28,796
it will be completely only doing this one thing.

110
00:04:28,798 --> 00:04:30,781
Again, sometimes that's what you want.

111
00:04:30,782 --> 00:04:32,765
But don't jump to modal view controllers as your a1 first

112
00:04:32,768 --> 00:04:35,535
solution to every time you want to put an MVC on screen.

113
00:04:35,537 --> 00:04:37,570
You got navigation controllers,

114
00:04:37,572 --> 00:04:40,873
you got split views, you got tab bars, stuff like that,

115
00:04:40,875 --> 00:04:43,842
those are usually better solutions if possible.

116
00:04:44,911 --> 00:04:47,545
All right, so how do we set up a modal segue?

117
00:04:47,547 --> 00:04:48,880
Very, very simple.

118
00:04:48,881 --> 00:04:50,214
You've got your storyboard, well,

119
00:04:50,216 --> 00:04:53,050
sometimes you'll get a MVC, like the alert MVC in code,

120
00:04:53,052 --> 00:04:55,652
and you put it up with that present view controller.

121
00:04:55,654 --> 00:04:57,020
And I'll talk about that here in a second.

122
00:04:57,022 --> 00:04:58,755
But if you're doing your own MVC,

123
00:04:58,757 --> 00:05:01,290
usually it's in your storyboard, you've built

124
00:05:01,292 --> 00:05:04,059
the MVC that you want to put up modally in there.

125
00:05:04,061 --> 00:05:06,294
And then you just Ctrl + drag to it.

126
00:05:06,296 --> 00:05:09,197
But instead of saying, show or show detail,

127
00:05:09,199 --> 00:05:11,332
you say present modally, okay?

128
00:05:11,334 --> 00:05:14,935
And that's just gonna make your MVC appear on screen and

129
00:05:14,937 --> 00:05:17,437
take over and it's as simple as that.

130
00:05:18,774 --> 00:05:21,040
You can inspect the segue.

131
00:05:21,042 --> 00:05:25,344
Anytime you make a segue you can always inspect it

132
00:05:25,346 --> 00:05:28,980
to set the style of segue modal,

133
00:05:28,982 --> 00:05:32,450
or push, or you know, the shows, or whatever.

134
00:05:32,452 --> 00:05:35,353
And you can also inspect the style or presentation of

135
00:05:35,355 --> 00:05:38,155
modal, which we'll show you in a second as well.

136
00:05:39,558 --> 00:05:42,359
So, if you need to present a modal view controller,

137
00:05:42,361 --> 00:05:45,595
not from a button, so you want some other action.

138
00:05:45,597 --> 00:05:47,897
Like, for example, you had a map view and

139
00:05:47,899 --> 00:05:50,566
you wanted a call-out button to do a modal thing,

140
00:05:50,568 --> 00:05:52,734
which is what we're gonna do today.

141
00:05:52,736 --> 00:05:55,070
Then you can perform segue from code.

142
00:05:55,072 --> 00:05:57,405
You already know how to do that.

143
00:05:57,407 --> 00:06:00,374
Or if you actually have the view controller in your hand,

144
00:06:00,376 --> 00:06:02,643
you got it cuz it's an alert view controller.

145
00:06:02,645 --> 00:06:05,045
Or when we do the camera we're gonna understand that

146
00:06:05,047 --> 00:06:07,347
the camera thing gives us a view controller.

147
00:06:07,349 --> 00:06:09,615
We can actually present the view controller using present

148
00:06:09,617 --> 00:06:10,817
view controller.

149
00:06:10,818 --> 00:06:12,018
Same way that we did alerts.

150
00:06:12,020 --> 00:06:13,986
And that's just going to present it.

151
00:06:15,055 --> 00:06:18,523
How it's presented is actually determined by a property

152
00:06:18,525 --> 00:06:21,292
on the view controller that's being presented.

153
00:06:21,294 --> 00:06:23,427
So a view controllers gets to say,

154
00:06:23,429 --> 00:06:26,730
here's how I want to be presented modally, okay.

155
00:06:26,732 --> 00:06:29,733
And that property is called modalPresentationStyle and

156
00:06:29,735 --> 00:06:31,167
it's an enumerated type.

157
00:06:31,169 --> 00:06:33,803
And here are some of the examples here, .FullScreen,

158
00:06:33,805 --> 00:06:34,870
which is the default,

159
00:06:34,872 --> 00:06:37,606
where it just comes up over the entire screen.

160
00:06:37,608 --> 00:06:39,941
There's .OverFullScreen, which is full screen, but

161
00:06:39,943 --> 00:06:42,744
it doesn't block out what's underneath.

162
00:06:42,746 --> 00:06:44,445
Okay, so things show through,

163
00:06:44,447 --> 00:06:46,647
the thing that is coming up on top of shows through.

164
00:06:46,649 --> 00:06:49,249
Now you can't interact with those things behind cause

165
00:06:49,251 --> 00:06:51,284
you're modal but they do show through.

166
00:06:51,286 --> 00:06:53,586
And then of course a .Popover is essentially,

167
00:06:53,588 --> 00:06:56,489
a modal presentation style cause a popover takes over

168
00:06:56,491 --> 00:06:58,091
the screen also.

169
00:06:58,092 --> 00:06:59,692
It just dims out the rest, you're working in your popover

170
00:06:59,694 --> 00:07:02,528
if you click anywhere else it makes the popover go away.

171
00:07:02,530 --> 00:07:04,129
There's some other ones, like form sheet,

172
00:07:04,131 --> 00:07:07,298
which I'll show you in the demo today for on the iPad.

173
00:07:07,300 --> 00:07:08,633
Sometimes you want to present something but

174
00:07:08,635 --> 00:07:09,967
you don't want it to be gigantic,

175
00:07:09,969 --> 00:07:10,968
filling the whole screen,

176
00:07:10,970 --> 00:07:12,135
you want it to be a little smaller.

177
00:07:12,137 --> 00:07:13,737
So we'll show you how to do that.

178
00:07:14,839 --> 00:07:18,040
You prepare for a modal segue exactly like any other segue.

179
00:07:18,042 --> 00:07:21,143
I didn't even put in any yellow on this slide,

180
00:07:21,145 --> 00:07:25,413
it's just normal code, there's nothing special there.

181
00:07:25,415 --> 00:07:27,215
Some people ask the question a lot,

182
00:07:27,217 --> 00:07:32,119
well how do i hear back from my modally segued to MVC.

183
00:07:32,121 --> 00:07:36,189
So like, in the contacts for example, I added a contact.

184
00:07:36,191 --> 00:07:37,824
Well when the contact is added,

185
00:07:37,826 --> 00:07:40,793
how does it communicate back to me, here's the contact.

186
00:07:40,795 --> 00:07:45,464
Well, actually the MVC that put that contact adding thing

187
00:07:45,466 --> 00:07:49,767
up, is probably sharing a model with the other one.

188
00:07:49,769 --> 00:07:51,635
Which is to say, the database of contact.

189
00:07:51,637 --> 00:07:53,337
So when you hit, add contact and you hit done,

190
00:07:53,339 --> 00:07:55,172
it probably just puts it in the database, okay.

191
00:07:55,174 --> 00:07:57,540
So it doesn't really need to communicate back.

192
00:07:57,542 --> 00:07:59,575
But if it did need to communicate back,

193
00:07:59,577 --> 00:08:01,410
the way you would do that is Unwind.

194
00:08:01,412 --> 00:08:02,461
Okay.

195
00:08:02,462 --> 00:08:03,511
Remember the unwinding segues?

196
00:08:03,514 --> 00:08:06,748
You would just make the done button or whatever in your

197
00:08:06,750 --> 00:08:10,585
modal thing, Ctr+drag it up to that little exit button.

198
00:08:10,587 --> 00:08:13,988
You define the special storyboard ID action thing and

199
00:08:13,990 --> 00:08:15,773
you would unwind.

200
00:08:15,774 --> 00:08:17,557
And that's how you would communicate back.

201
00:08:17,560 --> 00:08:19,993
A lot of times though modally presented view controllers

202
00:08:19,995 --> 00:08:22,295
they do what they do and then you just dismiss them.

203
00:08:22,297 --> 00:08:24,998
Because either they're editing this stuff in real time or

204
00:08:25,000 --> 00:08:26,699
they are sharing the model so

205
00:08:26,701 --> 00:08:28,968
they can edit the model directly.

206
00:08:28,970 --> 00:08:30,803
So then they'll just dismiss themselves.

207
00:08:30,805 --> 00:08:33,905
So dismissing without doing anything or

208
00:08:33,907 --> 00:08:37,975
unwinding is pretty much the way that Modally segued to

209
00:08:37,977 --> 00:08:40,511
controllers come off screen.

210
00:08:40,513 --> 00:08:41,945
So how do you dismiss it?

211
00:08:41,947 --> 00:08:44,448
Well if you unwind it automatically dismisses.

212
00:08:44,450 --> 00:08:46,183
As you know,

213
00:08:46,184 --> 00:08:47,917
unwind always includes a dismissal of whatever

214
00:08:47,919 --> 00:08:49,218
your controller is being unwound from.

215
00:08:49,220 --> 00:08:51,887
But if you're not unwinding, then you're going to call

216
00:08:51,889 --> 00:08:55,124
dismiss view controller animated which takes

217
00:08:55,126 --> 00:08:57,259
the boolean whether you're gonna animate the dismissal,

218
00:08:57,261 --> 00:08:59,427
which you're always gonna do, pretty much.

219
00:08:59,429 --> 00:09:04,131
And this is sent to the presenting view controller.

220
00:09:04,133 --> 00:09:05,799
The view controller that presents you.

221
00:09:05,801 --> 00:09:07,000
'Kay? That is the thing

222
00:09:07,002 --> 00:09:09,336
that is responsible for dismissing you.

223
00:09:09,338 --> 00:09:12,605
Now if you accidentally send this to the presented

224
00:09:12,607 --> 00:09:15,307
view controller it's gonna forward it on to its

225
00:09:15,309 --> 00:09:16,942
presenting view controller.

226
00:09:16,944 --> 00:09:18,744
Although it can be a little confusing if

227
00:09:18,746 --> 00:09:21,279
you have a presented view controller that, itself, has

228
00:09:21,281 --> 00:09:24,682
presented another one and you say dismiss view controller.

229
00:09:24,684 --> 00:09:27,351
Well, do you mean to dismiss the thing it presented?

230
00:09:27,353 --> 00:09:29,687
Or dismiss from the thing it was presenting?

231
00:09:29,689 --> 00:09:32,956
So that's why with the rule is, the presenting

232
00:09:32,958 --> 00:09:35,158
view controller is the one you should send this dismiss to.

233
00:09:35,160 --> 00:09:37,827
So I, personally, think it's wrong code for

234
00:09:37,829 --> 00:09:40,696
you to send dismiss view controller to the presented

235
00:09:40,698 --> 00:09:43,098
view controller expecting it to dismiss itself.

236
00:09:43,100 --> 00:09:44,132
'Kay?

237
00:09:44,134 --> 00:09:46,701
The presented view controller can get its

238
00:09:46,703 --> 00:09:49,337
presenting view controller at any time with the method, or

239
00:09:49,339 --> 00:09:52,073
the variable, presenting view controller.

240
00:09:52,075 --> 00:09:53,874
Okay, every view controller that's being presented

241
00:09:53,876 --> 00:09:55,809
knows it's presenting view controller and

242
00:09:55,811 --> 00:09:57,344
then it can just send this message to it.

243
00:09:57,346 --> 00:10:00,079
So we'll see that in the code of the demo as well.

244
00:10:01,549 --> 00:10:04,249
So how does the modal view controller appear onscreen?

245
00:10:04,251 --> 00:10:06,718
You've seen it slide up from the bottom, right?

246
00:10:06,720 --> 00:10:09,120
That's the default modal transition style,

247
00:10:09,122 --> 00:10:10,554
which is called cover vertical.

248
00:10:10,556 --> 00:10:14,291
And you, again, the view controller that's being

249
00:10:14,293 --> 00:10:17,494
presented gets to say how it wants to appear on screen.

250
00:10:17,496 --> 00:10:22,331
And so this is different than, you know, the modal style,

251
00:10:22,333 --> 00:10:24,000
like form sheet or something like that.

252
00:10:24,002 --> 00:10:26,335
This is how the animation happens, 'kay?

253
00:10:26,337 --> 00:10:28,236
How the actual transmission happens.

254
00:10:28,238 --> 00:10:29,571
And so, again,

255
00:10:29,573 --> 00:10:31,673
there's another property in the view controller that's

256
00:10:31,675 --> 00:10:34,442
being presented called Modal Transition Style.

257
00:10:34,444 --> 00:10:36,076
And cover vertical's the default,

258
00:10:36,078 --> 00:10:38,228
means slide up from the bottom.

259
00:10:38,229 --> 00:10:40,379
There's also flip horizontal, which will just flip over.

260
00:10:40,382 --> 00:10:43,516
Okay, take from the old, the view that's presenting view

261
00:10:43,518 --> 00:10:45,318
controller and the presented view controller,

262
00:10:45,320 --> 00:10:47,853
we'll flip over and exchange places.

263
00:10:47,855 --> 00:10:50,889
There's also cross dissolve where they'll fade out and

264
00:10:50,891 --> 00:10:52,925
the other one will fade in.

265
00:10:52,926 --> 00:10:54,960
There's even partial curl where the bottom corner

266
00:10:54,962 --> 00:10:59,997
will kind of curl up and show the new view controller.

267
00:10:59,999 --> 00:11:02,566
That one's a little interesting there because

268
00:11:02,568 --> 00:11:04,702
once you've done that one, you can't do any more

269
00:11:04,704 --> 00:11:06,436
modal transitions because it would make no sense.

270
00:11:06,438 --> 00:11:09,572
You've got this curled up kind of look and then you

271
00:11:09,574 --> 00:11:12,208
plant something on top of it, that just breaks the illusion

272
00:11:12,210 --> 00:11:14,810
of this being just a little piece of curled thing that

273
00:11:14,812 --> 00:11:17,279
lifts up to show you this modally presented thing.

274
00:11:17,281 --> 00:11:20,182
Obviously the partial curls gonna be small view

275
00:11:20,184 --> 00:11:21,750
controllers showing.

276
00:11:21,752 --> 00:11:24,719
It's kind of a fun one though sometimes like in the Maps app

277
00:11:24,721 --> 00:11:26,754
if you want to set some setting, so

278
00:11:26,756 --> 00:11:29,757
turn traffic on, it'll just curl up the map a little bit,

279
00:11:29,759 --> 00:11:31,925
you set your settings, and it curls it back down.

280
00:11:31,927 --> 00:11:32,709
Okay?

281
00:11:32,710 --> 00:11:33,492
So kind of fun though.

282
00:11:35,030 --> 00:11:37,797
All right, so the demo I'm gonna do today it's gonna show

283
00:11:37,799 --> 00:11:40,499
you all this stuff, modals, segues, all this stuff.

284
00:11:40,501 --> 00:11:43,068
It's probably gonna take us most of the rest of

285
00:11:43,070 --> 00:11:44,769
the time here.

286
00:11:44,771 --> 00:11:48,272
And I'll try to cover a lot of other things along the way.

287
00:11:48,274 --> 00:11:52,109
I'm gonna start out by doing some draggable MK annotations.

288
00:11:52,111 --> 00:11:54,778
I'm also gonna talk much more about notifications cuz,

289
00:11:54,780 --> 00:11:56,246
really, the only notification we did so

290
00:11:56,248 --> 00:11:58,481
far was where we notified ourself.

291
00:11:58,483 --> 00:12:01,217
So I'm gonna show you

292
00:12:01,218 --> 00:12:03,952
a little more sophisticated notification where system,

293
00:12:03,955 --> 00:12:06,789
another object is notifying us.

294
00:12:06,791 --> 00:12:12,527
Then I'm gonna go back and cover pop-overs some more.

295
00:12:12,529 --> 00:12:15,963
We covered a little bit back, way back when, in psychologist

296
00:12:15,965 --> 00:12:18,866
but we're gonna do a little more sophisticated popovers.

297
00:12:18,868 --> 00:12:21,702
We're also going to talk more about adaptive behavior,

298
00:12:21,704 --> 00:12:26,039
which is to say when you have a modal segway happening,

299
00:12:27,108 --> 00:12:29,408
what if it's on an iPhone versus an iPad?

300
00:12:29,410 --> 00:12:31,377
It doesn't always wanna look exactly the same.

301
00:12:31,379 --> 00:12:34,479
And so we're actually gonna get involved in making it look

302
00:12:34,481 --> 00:12:36,081
how we want.

303
00:12:36,082 --> 00:12:37,682
And as part of that I'm going to show you another thing that

304
00:12:37,684 --> 00:12:40,918
I don't have any slides on but it's very easy to use called,

305
00:12:40,920 --> 00:12:43,087
which is visual effects.

306
00:12:43,089 --> 00:12:44,488
So there's a way to get visual effects,

307
00:12:44,490 --> 00:12:47,591
like blurs and vibrancy, things like that.

308
00:12:47,593 --> 00:12:49,610
So I'll show you that.

309
00:12:49,611 --> 00:12:51,628
So you can see, a lot of stuff to go through here.

310
00:12:51,630 --> 00:12:52,879
And if we have time,

311
00:12:52,880 --> 00:12:54,129
we'll get back and do through the slides and the camera.

312
00:12:55,466 --> 00:12:57,633
All right so we're gonna go back to Trax and

313
00:12:57,635 --> 00:13:00,402
what we're gonna do here in Trax is we are going to make

314
00:13:00,404 --> 00:13:02,771
it so we can add our own Waypoints.

315
00:13:02,773 --> 00:13:05,206
Right now, Tracks just opens up the GPS file and

316
00:13:05,208 --> 00:13:07,808
shows you the Waypoints.

317
00:13:07,810 --> 00:13:09,810
And I'll show you,

318
00:13:09,812 --> 00:13:12,512
remind us what that looks like in case we've forgotten.

319
00:13:13,682 --> 00:13:15,548
All right. Here's our Tracks.

320
00:13:15,550 --> 00:13:18,951
And it shows us these nice waypoints down here.

321
00:13:18,953 --> 00:13:23,154
And we have a nice image over here, and we have this little

322
00:13:23,156 --> 00:13:27,258
button, disclosure button, which will show us the image

323
00:13:27,260 --> 00:13:28,759
in more detail where we can scroll around.

324
00:13:28,761 --> 00:13:30,761
Well, what we're gonna do now is make it so

325
00:13:30,763 --> 00:13:33,463
that if we long press, in other words, we press and

326
00:13:33,465 --> 00:13:36,666
hold, it's gonna drop a pin there for us.

327
00:13:36,668 --> 00:13:37,700
And then we're going to be able to set

328
00:13:37,702 --> 00:13:39,935
the little thing like Valley Floor there,

329
00:13:39,937 --> 00:13:41,937
or the views are spectacular even from here.

330
00:13:41,939 --> 00:13:43,838
We'll be able to set that for our thing.

331
00:13:43,840 --> 00:13:45,840
And we'll even be able to set an image once we learn

332
00:13:45,842 --> 00:13:48,376
about how to do the camera next time.

333
00:13:49,345 --> 00:13:52,346
But in order to make this work I'm actually gonna change our

334
00:13:52,348 --> 00:13:56,082
track slightly, which is right now to see this image in more

335
00:13:56,084 --> 00:14:00,419
detail, I press on this little detail disclosure button.

336
00:14:00,421 --> 00:14:04,589
I'm gonna change it so that you click on the image itself.

337
00:14:04,591 --> 00:14:08,293
To see the image in more detail so that I can free this

338
00:14:08,295 --> 00:14:11,662
up to be our, we just added a user waypoint and

339
00:14:11,664 --> 00:14:13,064
now we want to edit it, button.

340
00:14:13,066 --> 00:14:14,631
'Kay? So this is gonna be our

341
00:14:14,633 --> 00:14:17,601
editable user waypoint editing button.

342
00:14:17,603 --> 00:14:19,636
So I'm gonna make that change real quick.

343
00:14:19,638 --> 00:14:21,388
So let's go ahead and do that.

344
00:14:21,389 --> 00:14:23,139
That's really easy to do, it turns out.

345
00:14:23,141 --> 00:14:29,778
Right now when we build our callout view right here.

346
00:14:29,780 --> 00:14:32,347
'Kay? Here's a view for annotation?

347
00:14:32,349 --> 00:14:33,648
Okay? Here's where we

348
00:14:33,649 --> 00:14:34,948
build our callout accessory views.

349
00:14:34,951 --> 00:14:37,552
Instead of using a UI image view to build it,

350
00:14:37,554 --> 00:14:40,321
I'm just gonna make it be a UI button.

351
00:14:40,323 --> 00:14:42,373
'Kay?

352
00:14:42,374 --> 00:14:44,424
Now, of course, once I make it a UI button, I also have to

353
00:14:44,427 --> 00:14:47,661
make sure that I load this UI button up properly, so

354
00:14:47,663 --> 00:14:49,996
I'm gonna go down here to div select annotation view,

355
00:14:49,998 --> 00:14:52,999
which is where we currently load up that left callout

356
00:14:53,001 --> 00:14:54,934
access review.

357
00:14:54,935 --> 00:14:56,868
I'm gonna change this from being a thumbnail image view

358
00:14:56,871 --> 00:15:01,573
to calling it the thumbnail ImageButton

359
00:15:01,575 --> 00:15:03,641
because it's an image button now instead of an image view.

360
00:15:03,643 --> 00:15:08,012
And of course it's not a UI image here, it's a UI button.

361
00:15:08,014 --> 00:15:10,581
And then the only other thing is you don't set a buttons

362
00:15:10,583 --> 00:15:13,750
image by saying dot image equals image.

363
00:15:13,752 --> 00:15:16,419
You call a method actually called SetImage.

364
00:15:17,522 --> 00:15:19,522
Image.

365
00:15:19,523 --> 00:15:21,523
And it has, for state, because the button has various states,

366
00:15:21,525 --> 00:15:24,626
highlighted states, other kind of states, but we're just

367
00:15:24,628 --> 00:15:27,095
gonna set it for the normal state of the button.

368
00:15:27,097 --> 00:15:29,731
So that's the only change I need to make

369
00:15:29,733 --> 00:15:30,598
to make this work.

370
00:15:30,599 --> 00:15:31,464
So let's go take a look at this and

371
00:15:31,467 --> 00:15:34,568
here we can comment out now our little

372
00:15:34,570 --> 00:15:36,303
right callout detail thing.

373
00:15:36,305 --> 00:15:37,404
We don't need that.

374
00:15:37,406 --> 00:15:38,638
Bring it back in second here.

375
00:15:39,674 --> 00:15:41,507
But here's our things.

376
00:15:41,509 --> 00:15:43,508
And so now here when we click it notice we don't have

377
00:15:43,510 --> 00:15:46,611
the detailed disclosure on there anymore cuz I commented

378
00:15:46,613 --> 00:15:47,745
that out right here.

379
00:15:47,747 --> 00:15:49,847
But this is now a button so

380
00:15:49,849 --> 00:15:53,517
if I click it now I get to see my image, okay?

381
00:15:53,519 --> 00:15:55,919
So I haven't changed the functionality of my app at

382
00:15:55,921 --> 00:15:58,188
all, I just kind of moved it to be click on here as

383
00:15:58,190 --> 00:16:00,323
opposed to having the detailed disclosure.

384
00:16:00,325 --> 00:16:01,524
Okay, everybody cool?

385
00:16:01,526 --> 00:16:03,092
With that.

386
00:16:03,094 --> 00:16:04,793
All right.

387
00:16:04,795 --> 00:16:06,261
So, now we've done that.

388
00:16:06,263 --> 00:16:09,464
Now let's make it so that if I long press,

389
00:16:09,466 --> 00:16:13,701
which means press and hold, it drops a new pin, okay.

390
00:16:13,703 --> 00:16:15,669
So how do I do that?

391
00:16:15,670 --> 00:16:17,636
I'm just going to go to my storyboard here.

392
00:16:17,639 --> 00:16:19,239
And in my storyboard,

393
00:16:19,241 --> 00:16:24,110
I'm going to add a long press gesture to my map view, here.

394
00:16:24,112 --> 00:16:27,713
So let's go down here, pull this up.

395
00:16:27,715 --> 00:16:30,649
I'm gonna search for, long press.

396
00:16:30,651 --> 00:16:32,518
There it is, right there.

397
00:16:32,519 --> 00:16:34,386
So I'm just going to drag this gesture out onto my map

398
00:16:34,388 --> 00:16:35,386
view, okay.

399
00:16:35,388 --> 00:16:37,088
You can see that it appears over here in my

400
00:16:37,090 --> 00:16:38,856
document outline.

401
00:16:38,858 --> 00:16:39,990
Now let's bring up the code.

402
00:16:39,992 --> 00:16:43,159
Okay, I'll put this right here in the waypoints

403
00:16:43,161 --> 00:16:44,527
section right here.

404
00:16:44,529 --> 00:16:48,731
So I'm going to control drag from this long press gesture

405
00:16:48,733 --> 00:16:49,998
into here.

406
00:16:50,000 --> 00:16:52,133
It's going to be gesture.

407
00:16:52,135 --> 00:16:54,102
I'm going to call it addWaypoint.

408
00:16:54,104 --> 00:16:55,936
It's what it does.

409
00:16:55,938 --> 00:16:59,306
It's got the long press gesture as the argument here.

410
00:16:59,308 --> 00:17:01,041
All right, so there's that.

411
00:17:01,043 --> 00:17:02,676
Let's go back here.

412
00:17:02,678 --> 00:17:05,244
Let's go up to here, okay.

413
00:17:05,246 --> 00:17:09,114
So here is, where is that?

414
00:17:09,116 --> 00:17:09,998
Here it is.

415
00:17:09,999 --> 00:17:10,881
This is the thing I just added,

416
00:17:10,884 --> 00:17:12,484
this LongPressGesture right here.

417
00:17:13,753 --> 00:17:15,519
So what do we need to do inside

418
00:17:15,521 --> 00:17:17,421
of this LongPressGesture?

419
00:17:17,423 --> 00:17:19,556
Really not a whole lot to do.

420
00:17:19,558 --> 00:17:23,760
I'm gonna say if the sender.state,

421
00:17:23,762 --> 00:17:27,329
that's the state of the gesture, basically.

422
00:17:27,331 --> 00:17:31,900
If that equals UIGestureRecognizerState.be-

423
00:17:31,902 --> 00:17:36,337
gan, now I could do this when this long press starts,

424
00:17:36,339 --> 00:17:38,322
which is, I'm doing.

425
00:17:38,323 --> 00:17:40,306
Or I could do it when the long press ends.

426
00:17:40,309 --> 00:17:42,976
And long pressed by the way, you'll get changed, also,

427
00:17:42,978 --> 00:17:46,279
as you hold it down, you'll get a change happening.

428
00:17:46,281 --> 00:17:48,181
But I like to do it when I began,

429
00:17:48,183 --> 00:17:49,716
because I want instant feedback.

430
00:17:49,718 --> 00:17:51,183
The user holds the long press,

431
00:17:51,185 --> 00:17:54,520
as soon as it's recognized as a long press and begins, boom,

432
00:17:54,522 --> 00:17:56,355
we're gonna drop that pin down there.

433
00:17:56,357 --> 00:17:58,890
So they don't have to hold their finger any longer and

434
00:17:58,892 --> 00:17:59,924
they don't have to hold it down and

435
00:17:59,926 --> 00:18:01,992
say, hm, where's that, nothings happening.

436
00:18:01,994 --> 00:18:05,529
Okay, so that's why I decided to do it on began here.

437
00:18:06,565 --> 00:18:10,466
And to create one we need the coordinates that they clicked

438
00:18:10,468 --> 00:18:13,402
on, right, or that they long pressed, they held down.

439
00:18:13,404 --> 00:18:17,306
We need to find out the CL location coordinate 2D.

440
00:18:17,308 --> 00:18:20,175
Where in the world they just did that.

441
00:18:20,177 --> 00:18:23,745
And to do that we're going to use this method in map view

442
00:18:23,747 --> 00:18:26,881
called convertPoint, which takes a point, so

443
00:18:26,883 --> 00:18:30,551
let's get the location of the gesture in the map view's

444
00:18:30,553 --> 00:18:33,320
coordinate systems, okay.

445
00:18:33,322 --> 00:18:35,789
And it converts it to the coordinate system of any view

446
00:18:35,791 --> 00:18:37,441
you want.

447
00:18:37,442 --> 00:18:39,092
Which we're going to actually convert it the mapView's

448
00:18:39,094 --> 00:18:43,429
coordinate system which is not much of a conversion, okay.

449
00:18:43,431 --> 00:18:45,497
So that creates a view.

450
00:18:45,499 --> 00:18:50,702
So we've converted this gesture to this coordinate

451
00:18:50,704 --> 00:18:54,505
in the mapView, so now we have a CL location coordinate 2D,

452
00:18:54,507 --> 00:18:56,040
here I'll click on this so

453
00:18:56,041 --> 00:18:57,574
you can see that's a CLLocationCoordinate2D,

454
00:18:57,576 --> 00:18:59,509
that's where the person pressed down.

455
00:18:59,511 --> 00:19:03,813
So now I'm just gonna create the waypoint, and we can

456
00:19:03,815 --> 00:19:08,283
create the waypoint using GPX waypoint, it only has one

457
00:19:08,285 --> 00:19:12,687
constructor which is the latitude and the longitude.

458
00:19:12,689 --> 00:19:14,689
Okay, so now we've created a waypoint.

459
00:19:14,691 --> 00:19:17,524
Maybe we'll set some things in the waypoint, like the name.

460
00:19:17,526 --> 00:19:18,725
We just dropped this, so

461
00:19:18,727 --> 00:19:21,828
I'm going to call this the waypoint dropped, okay.

462
00:19:21,830 --> 00:19:26,432
And then let's just add this annotation

463
00:19:26,434 --> 00:19:28,934
to the map view, okay.

464
00:19:28,936 --> 00:19:31,269
So that's all we need to do to drop something on there.

465
00:19:31,271 --> 00:19:32,203
So let's go take a look at that.

466
00:19:36,509 --> 00:19:38,559
All right, so here's all our points.

467
00:19:38,560 --> 00:19:40,610
And I'm just gonna long press, you see it dropped one there.

468
00:19:40,613 --> 00:19:42,579
And if I click on it, it says, dropped.

469
00:19:42,581 --> 00:19:44,247
Now, I don't have any image associated with.

470
00:19:44,249 --> 00:19:47,650
I don't have any little sub-information info

471
00:19:47,652 --> 00:19:49,585
field on here.

472
00:19:49,586 --> 00:19:51,519
So, we need to make it so that it does that.

473
00:19:51,522 --> 00:19:52,688
But first, I'm going to make it so

474
00:19:52,690 --> 00:19:54,356
that this can be dragged.

475
00:19:54,358 --> 00:19:56,224
Because what if I dropped it here, and

476
00:19:56,226 --> 00:19:59,127
then I looked in here closer and I was like,

477
00:19:59,129 --> 00:20:02,063
oh no I wanted to drop it on the other side of that road.

478
00:20:02,065 --> 00:20:03,497
Okay, I can't pick it up.

479
00:20:03,499 --> 00:20:06,833
So I'd like to be able to pick this thing up and move it.

480
00:20:06,835 --> 00:20:08,435
So what do we need to do that?

481
00:20:08,437 --> 00:20:12,338
That's very simple as well, we just need to make,

482
00:20:12,340 --> 00:20:16,275
back here remember, here's our extension to GPX waypoint that

483
00:20:16,277 --> 00:20:19,778
we extended so that it would be an MK annotation.

484
00:20:19,780 --> 00:20:21,813
We just need to make this note be a get only,

485
00:20:21,815 --> 00:20:23,448
it needs to be set and get.

486
00:20:23,450 --> 00:20:25,149
That's really the only thing you need to do to make

487
00:20:26,652 --> 00:20:28,118
something be draggable.

488
00:20:28,120 --> 00:20:30,387
Now, I'm gonna do that in a separate subclass here.

489
00:20:30,389 --> 00:20:34,190
I'm gonna call it EditableWaypoint, okay,

490
00:20:34,192 --> 00:20:36,793
it's a subclass of GPX.Waypoint.

491
00:20:36,795 --> 00:20:42,531
And all it's going to do is override that var coordinate,

492
00:20:42,533 --> 00:20:46,601
and it's perfectly fine to override a var

493
00:20:46,603 --> 00:20:50,138
in a subclass to turn it into set and get.

494
00:20:50,140 --> 00:20:54,441
So the get is just gonna return supers version of this,

495
00:20:54,443 --> 00:20:56,777
okay.

496
00:20:56,779 --> 00:21:01,014
And our set, all I'm gonna do on my set, is I'm going to set

497
00:21:01,016 --> 00:21:04,917
my latitude equal to the new values latitude.

498
00:21:04,919 --> 00:21:07,419
And I'm gonna set my longitude,

499
00:21:07,421 --> 00:21:09,387
equal to the new values longitude.

500
00:21:09,389 --> 00:21:12,957
Okay, and remember that latitude and longitude,

501
00:21:12,959 --> 00:21:16,493
these are just properties in GPX waypoints, okay.

502
00:21:17,696 --> 00:21:19,429
Well it has links, you know,

503
00:21:19,431 --> 00:21:22,131
to our thumbnail images and all that stuff.

504
00:21:22,133 --> 00:21:23,532
But really, the main thing about

505
00:21:23,534 --> 00:21:25,434
GPX waypoint is just the latitude and longitude.

506
00:21:25,436 --> 00:21:28,937
So now we've made this new class, EditableWaypoint, which

507
00:21:28,939 --> 00:21:34,475
is a GPX waypoint, but it has a settable coordinate, okay.

508
00:21:34,477 --> 00:21:37,545
So down here, instead of creating a GPX waypoint,

509
00:21:37,547 --> 00:21:42,949
when we long press we're gonna create an editable waypoint,

510
00:21:42,951 --> 00:21:44,284
okay.

511
00:21:44,286 --> 00:21:45,785
One other thing you need to do though,

512
00:21:45,787 --> 00:21:49,155
is that pin annotation, okay, the little

513
00:21:49,157 --> 00:21:52,224
pin, we need to say that it's draggable, so I'm gonna say

514
00:21:52,226 --> 00:21:55,627
view.draggable to set this thing to be draggable.

515
00:21:55,629 --> 00:21:58,697
But I'm only going to do that if the annotation

516
00:21:58,699 --> 00:22:00,898
is an editable way point.

517
00:22:02,902 --> 00:22:05,502
Okay, remember is is kind of like as, but

518
00:22:05,504 --> 00:22:08,204
you're just testing it to see if it is,

519
00:22:08,206 --> 00:22:11,374
rather than casting it to be something else, okay.

520
00:22:11,376 --> 00:22:12,808
So that's it.

521
00:22:12,810 --> 00:22:14,243
So, let's go back.

522
00:22:14,245 --> 00:22:16,678
Now our user waypoints should be draggable.

523
00:22:16,680 --> 00:22:18,747
All right, we'll drop one here.

524
00:22:18,749 --> 00:22:21,683
And I can pick it up here and move it over onto the other

525
00:22:21,685 --> 00:22:24,285
side of the river there, okay, anywhere I want.

526
00:22:24,287 --> 00:22:27,688
Notice that these ones down here are not draggable.

527
00:22:27,690 --> 00:22:30,590
Can't drag them because they're not of class

528
00:22:30,592 --> 00:22:35,228
EditableWaypoint, they're just GPX.waypoint, okay?

529
00:22:35,230 --> 00:22:38,564
So draggable is really easy to do.

530
00:22:38,566 --> 00:22:43,101
So now I freed up that right detail disclosure call-out,

531
00:22:43,103 --> 00:22:46,871
and we're going to turn that into our edit uneditable

532
00:22:46,873 --> 00:22:48,005
waypoint, right?

533
00:22:48,007 --> 00:22:50,507
Change the name field, change the info field,

534
00:22:50,509 --> 00:22:53,010
add an image to it, all that stuff.

535
00:22:53,012 --> 00:22:55,679
That's what we're gonna make that be.

536
00:22:55,681 --> 00:22:57,513
So let's go back down here.

537
00:22:57,515 --> 00:22:58,814
Here's the old code we had for

538
00:22:58,816 --> 00:23:01,583
that rightCalloutAccessoryView, and

539
00:23:01,585 --> 00:23:03,485
I want most of that.

540
00:23:03,486 --> 00:23:05,386
But instead of adding that little detailed disclosure

541
00:23:05,389 --> 00:23:06,654
when the waypoint has an image,

542
00:23:06,656 --> 00:23:13,294
I'm gonna do it whenever the annotation is an editable one.

543
00:23:13,296 --> 00:23:15,997
So if it's editable,

544
00:23:15,998 --> 00:23:18,699
I'm gonna put that little detail disclosure there, okay.

545
00:23:18,701 --> 00:23:25,905
So now, we have to modally segue because this new MVC,

546
00:23:25,907 --> 00:23:28,874
we're gonna need a new MVC that lets us edit the name and

547
00:23:28,876 --> 00:23:31,010
the image of a wavepoint.

548
00:23:31,012 --> 00:23:32,744
We're going to do that modally.

549
00:23:32,746 --> 00:23:33,945
We're gonna do a modal segue.

550
00:23:33,947 --> 00:23:35,346
We just learned about modal segues.

551
00:23:35,348 --> 00:23:36,580
How are we gonna do that?

552
00:23:36,582 --> 00:23:39,149
Well this is the rightCalloutAccessoryView

553
00:23:39,151 --> 00:23:42,719
here, so I'm gonna go down to where the CalloutAccessoryView

554
00:23:42,721 --> 00:23:45,722
is tapped, and right now it just always does the show

555
00:23:45,724 --> 00:23:48,958
image segue way, which I still want it to do if we tapped on

556
00:23:48,960 --> 00:23:50,926
the leftCalloutAccessoryView,

557
00:23:50,928 --> 00:23:53,996
but if we tapped on the right one, I want it to edit it.

558
00:23:53,998 --> 00:23:55,964
So I'm gonna put a little if-then in here to

559
00:23:55,966 --> 00:23:58,033
that effect.

560
00:23:58,034 --> 00:24:00,101
So I'm actually gonna say, if the control that we tapped on.

561
00:24:00,103 --> 00:24:03,471
As a button which they both should be buttons okay, but

562
00:24:03,473 --> 00:24:05,973
I'm just gonna make sure here.

563
00:24:05,975 --> 00:24:11,244
If the button type equals UI button type detail

564
00:24:11,246 --> 00:24:13,947
disclosures, so if it's the detail disclosure button, then

565
00:24:13,949 --> 00:24:20,519
I'm going to do my modal segue to edit my waypoint, okay.

566
00:24:20,521 --> 00:24:25,023
Otherwise, I'm going to do a little more of a check here.

567
00:24:25,025 --> 00:24:28,026
I'm going to say, if the waypoint equals the views

568
00:24:28,028 --> 00:24:31,963
annotation as a GPX.Waypoint,

569
00:24:31,965 --> 00:24:35,866
which it should because the only kind of.

570
00:24:37,670 --> 00:24:39,302
An annotation that I even have,

571
00:24:39,304 --> 00:24:40,970
aur GPX Waypoint annotations.

572
00:24:40,972 --> 00:24:43,873
But in the future, what if I added something else in there?

573
00:24:43,875 --> 00:24:45,674
So I'm just being a little careful.

574
00:24:45,676 --> 00:24:50,545
I'm also gonna say, if the Waypoint.imageURL does

575
00:24:50,547 --> 00:24:54,415
not equal nil, cuz if there's no URL in the Waypoint,

576
00:24:54,417 --> 00:24:58,519
then I don't want to segue to that image showing

577
00:24:58,521 --> 00:25:00,354
the image view controller, right?

578
00:25:00,356 --> 00:25:03,256
So, I'm just protecting myself a little bit here to make sure

579
00:25:03,258 --> 00:25:04,123
that I actually have it.

580
00:25:04,125 --> 00:25:05,391
Cuz I might have a thumbnail but

581
00:25:05,393 --> 00:25:08,227
I don't have the image, possibly, unlikely.

582
00:25:08,229 --> 00:25:09,995
All right. So, how about edit waypoint?

583
00:25:09,997 --> 00:25:12,163
What are we going to do in edit waypoint?

584
00:25:12,165 --> 00:25:14,799
Well, we're just going to segue.

585
00:25:14,801 --> 00:25:19,870
So I'm going to perform a segue with identifier.

586
00:25:19,872 --> 00:25:22,305
I need a new identifier because I'm not segueing to

587
00:25:22,307 --> 00:25:25,575
the image thing, I'm segueing to an editing waypoint thing.

588
00:25:25,577 --> 00:25:27,377
So I have a constant for that,

589
00:25:27,379 --> 00:25:31,180
actually, called EditWaypointSegue.

590
00:25:31,182 --> 00:25:33,399
Okay.

591
00:25:33,400 --> 00:25:35,617
So EditWaypointSegue is down in my constants sections here.

592
00:25:35,619 --> 00:25:36,751
It's Edit Waypoint.

593
00:25:36,753 --> 00:25:39,220
Okay, so this is what we're going to have to make sure

594
00:25:39,222 --> 00:25:41,555
we put in our storyboard for that segue.

595
00:25:41,557 --> 00:25:43,223
Just like we put this in our storyboard for

596
00:25:43,225 --> 00:25:43,824
the image segue.

597
00:25:43,826 --> 00:25:45,358
All right.

598
00:25:45,360 --> 00:25:46,526
So it's at a waypoint.

599
00:25:46,528 --> 00:25:50,229
And sender, again, we'll have the sender be the view.

600
00:25:50,231 --> 00:25:52,231
Okay, the annotation view.

601
00:25:52,232 --> 00:25:54,232
Cuz that's really who's kind of causing this to happen,

602
00:25:54,234 --> 00:25:56,968
cuz we're in its call out so it's the calling it out.

603
00:25:56,970 --> 00:25:58,369
Now the other thing I'm going to do here is I'm

604
00:25:58,371 --> 00:26:02,506
actually going to deselect this annotation.

605
00:26:02,508 --> 00:26:04,908
Probably I would want to unwind,

606
00:26:04,910 --> 00:26:06,209
come back and reselect it.

607
00:26:06,211 --> 00:26:09,278
But I want it to be deselected because it's currently showing

608
00:26:09,280 --> 00:26:13,549
the current state of the annotation,

609
00:26:13,551 --> 00:26:17,452
of the waypoint, and I'm going to be changing that.

610
00:26:17,454 --> 00:26:20,121
So when I come back, I don't want it to be there.

611
00:26:20,123 --> 00:26:24,292
Okay, it's showing the old data I wanted to be,

612
00:26:24,294 --> 00:26:26,861
I either want you to have to force you to redisplay it or

613
00:26:26,863 --> 00:26:28,829
maybe, if I were going to add more code,

614
00:26:28,831 --> 00:26:30,497
I could make it so that it redisplayed.

615
00:26:30,499 --> 00:26:33,800
But, in any case, I definitely want this annotation to be

616
00:26:33,802 --> 00:26:40,139
deselected when I segue it to go edit it.

617
00:26:41,976 --> 00:26:42,675
Okay?

618
00:26:42,676 --> 00:26:43,375
All right, so that's it.

619
00:26:43,377 --> 00:26:45,010
That's all we need to do here.

620
00:26:45,012 --> 00:26:47,111
We just need to go to our storyboard now and

621
00:26:47,113 --> 00:26:51,315
create that new MBC that edits this thing and add this segue.

622
00:26:51,317 --> 00:26:52,249
So let's do that.

623
00:26:52,251 --> 00:26:55,118
Let's go to our storyboard, and

624
00:26:55,120 --> 00:26:57,887
we're gonna be segueing from our map view again.

625
00:26:57,889 --> 00:27:00,089
Inside one of the call-outs we're going to be segueing.

626
00:27:00,091 --> 00:27:02,324
So just like we have this segue right here,

627
00:27:02,326 --> 00:27:05,894
that came from this little thing.

628
00:27:05,896 --> 00:27:08,430
Our new one's gonna come from this little guy, too.

629
00:27:08,432 --> 00:27:10,264
So let's go ahead and get one.

630
00:27:10,266 --> 00:27:13,534
Let's go down here and add a new view controller.

631
00:27:13,536 --> 00:27:15,135
So I'm creating a brand new view controller.

632
00:27:15,137 --> 00:27:17,504
We'll pop it up here.

633
00:27:17,506 --> 00:27:18,304
Okay? Move it out of

634
00:27:18,306 --> 00:27:19,272
the way a little.

635
00:27:19,274 --> 00:27:20,439
And I'm gonna segue,

636
00:27:20,441 --> 00:27:22,608
just the way I did before, from this thing.

637
00:27:22,610 --> 00:27:24,276
Control drag.

638
00:27:24,278 --> 00:27:26,077
Okay, to segue to this.

639
00:27:26,079 --> 00:27:28,212
But this time I'm going to do present modally.

640
00:27:28,214 --> 00:27:30,981
Last time we did show, we were in a navigation controller

641
00:27:30,983 --> 00:27:32,666
down there, but we said show.

642
00:27:32,667 --> 00:27:34,350
So this time even though I'm in navigation controller,

643
00:27:34,353 --> 00:27:36,153
I'm still going to say present modally,

644
00:27:36,155 --> 00:27:38,788
which is going to cause this new view controller to come up

645
00:27:38,790 --> 00:27:39,922
over the whole screen.

646
00:27:39,924 --> 00:27:40,956
Question? >> If you worked in

647
00:27:40,958 --> 00:27:42,991
a navigation controller letter and if not,

648
00:27:42,993 --> 00:27:44,659
which one would you suggest using?

649
00:27:44,661 --> 00:27:46,027
>> Yeah, so the question was,

650
00:27:46,028 --> 00:27:47,394
if I wasn't in a navigation controller.

651
00:27:47,397 --> 00:27:48,796
If you look here.

652
00:27:48,798 --> 00:27:50,598
See this guy right here?

653
00:27:50,599 --> 00:27:52,399
He's in this navigation controller right here.

654
00:27:52,402 --> 00:27:54,968
If I weren't in a navigation controller, would it make any

655
00:27:54,970 --> 00:27:57,170
difference to this modal segue and the answer is no.

656
00:27:57,172 --> 00:27:59,039
Modal segues don't care where you are.

657
00:27:59,041 --> 00:28:02,208
They're going to take over the screen and show themselves.

658
00:28:02,210 --> 00:28:04,177
Okay.

659
00:28:04,178 --> 00:28:06,145
And the question of is it better to be or not to be,

660
00:28:06,147 --> 00:28:08,380
if you're presenting modal it really doesn't matter.

661
00:28:08,382 --> 00:28:10,349
But if you're in a navigation controller it's nice because

662
00:28:10,351 --> 00:28:13,852
you can have this kind of segue which is pushing, okay.

663
00:28:13,854 --> 00:28:16,421
And you could argue this whole editing of the waypoint,

664
00:28:16,423 --> 00:28:17,988
maybe that should be a push.

665
00:28:17,990 --> 00:28:20,758
And you go push to a place where you edit it, and then

666
00:28:20,760 --> 00:28:24,261
you hit save or done, but it's kind of ambiguous then unless.

667
00:28:24,263 --> 00:28:26,329
When you edit it, you're going to change it live,

668
00:28:26,331 --> 00:28:28,348
like we're going to do our modal one.

669
00:28:28,349 --> 00:28:30,366
So, I'm showing you this to show you modal segues, but

670
00:28:30,368 --> 00:28:32,368
I actually, if I were really writing an app,

671
00:28:32,370 --> 00:28:34,603
I'd probably push to this and

672
00:28:34,605 --> 00:28:36,905
have it be live editing, where if I change something,

673
00:28:36,907 --> 00:28:39,607
it's changing that thing in real time.

674
00:28:39,609 --> 00:28:41,943
Cuz that's how I'm going to do this modal anyway.

675
00:28:41,945 --> 00:28:44,779
The modals, actually, may be better when you are presenting

676
00:28:44,781 --> 00:28:46,513
something that you're going to allow them to edit, and

677
00:28:46,515 --> 00:28:48,882
then hit cancel, 'kay?

678
00:28:48,884 --> 00:28:50,283
Versus Save.

679
00:28:50,285 --> 00:28:51,684
That modal might be better for that, but

680
00:28:51,686 --> 00:28:54,320
here I'm just trying to show you the mechanics of modal.

681
00:28:54,322 --> 00:28:56,255
So here's out modal segue right here.

682
00:28:56,257 --> 00:28:58,223
We gotta make sure we put its identifier,

683
00:28:58,225 --> 00:29:00,525
Edit Waypoint, we're gonna call it.

684
00:29:00,527 --> 00:29:02,660
You can see that segue says modal.

685
00:29:02,662 --> 00:29:05,262
And I told you here that you can control things like

686
00:29:05,264 --> 00:29:07,564
the presentation style of it.

687
00:29:07,566 --> 00:29:09,099
And I'm going to show you that when we

688
00:29:09,101 --> 00:29:12,268
go look at this on an iPad in a moment here.

689
00:29:12,270 --> 00:29:14,170
But for an iPhone it doesn't really matter because it's

690
00:29:14,172 --> 00:29:15,671
always going to slide up from the bottom.

691
00:29:15,673 --> 00:29:20,142
That's the way iPhones present modal segues by default.

692
00:29:21,445 --> 00:29:23,578
Okay, so we have this nice thing, so let's go ahead and

693
00:29:23,580 --> 00:29:24,545
run this and see what this.

694
00:29:25,514 --> 00:29:27,147
What we made happen here.

695
00:29:27,149 --> 00:29:32,118
All right, so now I'm going to add a new thing here.

696
00:29:32,120 --> 00:29:33,552
It's dragable, right?

697
00:29:33,554 --> 00:29:35,421
I can pick it up, put it somewhere else.

698
00:29:35,423 --> 00:29:37,156
It's here. It says dropped.

699
00:29:37,157 --> 00:29:38,890
And now, when I click on this, notice that these guys,

700
00:29:38,892 --> 00:29:42,494
by the way, don't have the editable thing.

701
00:29:42,496 --> 00:29:44,495
They still have their image, okay?

702
00:29:44,497 --> 00:29:46,530
But they don't have, they're editable.

703
00:29:46,532 --> 00:29:47,998
But this one has this whole editable, so

704
00:29:48,000 --> 00:29:50,634
I'm going to click on this and we'll see what happens.

705
00:29:50,636 --> 00:29:51,869
Okay?

706
00:29:51,870 --> 00:29:53,103
Perfect. Slides up from the bottom.

707
00:29:53,105 --> 00:29:55,405
I'm this modal MVC where I can edit the waypoint.

708
00:29:55,407 --> 00:29:59,808
Now we have a built-in UI to do that, but, here we are.

709
00:29:59,810 --> 00:30:01,076
Kay?

710
00:30:01,078 --> 00:30:04,479
So, now we're going to put our UI in here to edit this.

711
00:30:04,481 --> 00:30:06,447
So let's do that.

712
00:30:06,449 --> 00:30:08,199
That's right here.

713
00:30:08,200 --> 00:30:09,950
It's going to be a pretty simple UI,

714
00:30:09,952 --> 00:30:13,286
I'm just going to get a couple of text fields out here.

715
00:30:14,389 --> 00:30:16,622
Okay, a text field for the name, a text field for

716
00:30:16,624 --> 00:30:18,491
that little info field.

717
00:30:18,493 --> 00:30:20,392
A label for each of those.

718
00:30:20,394 --> 00:30:22,494
That's pretty much my entire UI.

719
00:30:22,496 --> 00:30:24,629
One label is called Name.

720
00:30:24,631 --> 00:30:26,864
I'm gonna add those, it will be my line.

721
00:30:26,866 --> 00:30:28,799
The other one is called, let's call it Info.

722
00:30:28,801 --> 00:30:31,368
Have that be right aligned.

723
00:30:31,370 --> 00:30:33,036
We'll put this up in the corner here and

724
00:30:33,038 --> 00:30:37,440
do all of our auto-layout constraints.

725
00:30:37,442 --> 00:30:38,864
We'll put that there,

726
00:30:38,865 --> 00:30:40,287
we'll put this one up in this corner.

727
00:30:40,288 --> 00:30:41,710
Actually we'll have them align their baselines right there,

728
00:30:41,713 --> 00:30:43,212
it's a good idea.

729
00:30:43,214 --> 00:30:44,413
This guy.

730
00:30:44,415 --> 00:30:45,080
Try and align.

731
00:30:45,082 --> 00:30:45,980
Whoops.

732
00:30:45,982 --> 00:30:47,548
Align his baseline if we can.

733
00:30:47,550 --> 00:30:49,016
Yeah, there he is.

734
00:30:49,018 --> 00:30:50,951
Yeah, there we go.

735
00:30:50,953 --> 00:30:52,686
There and align the baseline.

736
00:30:52,688 --> 00:30:55,288
Let's drag this all the way over here like this.

737
00:30:56,624 --> 00:30:59,024
This one over here, we'll try to line these up.

738
00:30:59,026 --> 00:31:04,429
Okay, one thing that I want to do here is.

739
00:31:04,431 --> 00:31:06,898
So let's just set all our constraints here at all once.

740
00:31:06,900 --> 00:31:08,332
I'm going to do it really quickly.

741
00:31:08,334 --> 00:31:09,784
Again, you've seen so

742
00:31:09,785 --> 00:31:11,235
many how to layout demos you don't see a little more,

743
00:31:11,237 --> 00:31:13,870
but I'm going to left this guy to the trailing edge.

744
00:31:13,872 --> 00:31:16,106
I'm going to hook this guy to the trailing edge.

745
00:31:16,108 --> 00:31:17,874
I'm gonna hook this guy to the top.

746
00:31:17,876 --> 00:31:20,710
I'm gonna hook this guy to the bottom, but

747
00:31:20,712 --> 00:31:23,912
this is kind of an interesting one because I'm going to hook

748
00:31:23,914 --> 00:31:26,381
him to the bottom with greater than or equal.

749
00:31:26,383 --> 00:31:29,084
Because I really just want to make sure that he's

750
00:31:29,086 --> 00:31:32,286
the standard value distance away from the bottom or

751
00:31:32,288 --> 00:31:33,220
more, okay.

752
00:31:33,222 --> 00:31:34,621
I don't really care,

753
00:31:34,623 --> 00:31:37,324
I just never want him to smash into the bottom.

754
00:31:37,326 --> 00:31:38,725
So we'll do that.

755
00:31:38,726 --> 00:31:40,125
Let's go ahead and put this one here.

756
00:31:40,128 --> 00:31:41,761
Leading space.

757
00:31:41,763 --> 00:31:44,296
This one also, leading.

758
00:31:44,298 --> 00:31:47,566
Let's put these two separated by a vertical space.

759
00:31:47,568 --> 00:31:49,368
Let's separate these.

760
00:31:49,370 --> 00:31:50,902
Let's separate this.

761
00:31:50,904 --> 00:31:55,573
I want this one and this one, sorry, this one and this one,

762
00:31:55,575 --> 00:31:58,676
to always be lined up their left edges.

763
00:31:58,678 --> 00:32:01,511
Right, I don't want this to be ragged edged,

764
00:32:01,513 --> 00:32:04,814
so I'm gonna line their left edges up as well.

765
00:32:04,816 --> 00:32:08,184
So it looks like we got all of our things except for

766
00:32:08,186 --> 00:32:09,485
vertical position for name.

767
00:32:09,487 --> 00:32:10,786
Okay, that's because,

768
00:32:10,788 --> 00:32:16,124
let's line up these baselines, baseline here, baseline here.

769
00:32:16,126 --> 00:32:18,860
All right, so all gone, everything's lined up, okay.

770
00:32:18,862 --> 00:32:20,928
Wow we didn't even need to update our frames,

771
00:32:20,930 --> 00:32:23,263
we have this perfect looking UI here, okay.

772
00:32:24,766 --> 00:32:27,166
Sound good?

773
00:32:27,168 --> 00:32:29,802
All right, now let's wire these text fields up.

774
00:32:29,804 --> 00:32:31,170
So to wire these text field up,

775
00:32:31,172 --> 00:32:35,640
we need a custom subclass of UIViewController.

776
00:32:35,642 --> 00:32:37,475
Right, cuz now this is just a generic,

777
00:32:37,477 --> 00:32:38,876
if we look at its identity inspector,

778
00:32:38,878 --> 00:32:42,246
it's a generic UIViewController, so

779
00:32:42,248 --> 00:32:44,915
we need a custom subclass, no problem.

780
00:32:44,917 --> 00:32:46,549
We'll do that, we know how to do that.

781
00:32:47,619 --> 00:32:49,485
Okay, we're gonna call this our

782
00:32:49,487 --> 00:32:53,088
EditWaypointViewController, cuz that's what it does.

783
00:32:53,090 --> 00:32:55,724
This MVC that we're putting up, it edits waypoints so

784
00:32:55,726 --> 00:32:57,492
we'll call it EditWaypointViewController.

785
00:32:58,661 --> 00:32:59,727
Here it is.

786
00:32:59,729 --> 00:33:02,062
Let's go back to our storyboard here.

787
00:33:02,064 --> 00:33:05,832
I'm gonna change this guy's identity to be

788
00:33:05,834 --> 00:33:08,101
EditWaypointViewController, okay.

789
00:33:08,103 --> 00:33:11,771
So it's on automatic mode here so, we got our thing here.

790
00:33:11,773 --> 00:33:15,341
I'm going to delete all but viewDidLoad, okay.

791
00:33:16,777 --> 00:33:20,078
Let's go and hook these two things up, these text fields.

792
00:33:20,080 --> 00:33:21,546
So, I'm gonna Control-Drag here,

793
00:33:21,548 --> 00:33:23,047
we'll call this the nameTextField.

794
00:33:24,450 --> 00:33:28,985
And we'll drag this one, we'll call it the info TextField,

795
00:33:28,987 --> 00:33:30,920
okay, so there is our UI.

796
00:33:30,922 --> 00:33:34,590
Now, we need to think a little bit at what's the model for

797
00:33:34,592 --> 00:33:36,225
our EditWaypointViewController.

798
00:33:36,227 --> 00:33:38,393
Can anyone think of what the model for

799
00:33:38,395 --> 00:33:41,663
an MVC that edits a waypoint, what would be its model?

800
00:33:46,035 --> 00:33:47,968
What does it do?

801
00:33:47,970 --> 00:33:49,202
Edits a waypoint, right?

802
00:33:50,372 --> 00:33:54,240
So its model might be a waypoint?

803
00:33:55,242 --> 00:33:56,975
Yes.

804
00:33:56,976 --> 00:33:58,709
Let's make it be the waypoint to edit, okay?

805
00:33:58,712 --> 00:34:00,311
So it's going to be an editable waypoint.

806
00:34:00,313 --> 00:34:04,515
It's gonna be the model for this viewController.

807
00:34:04,517 --> 00:34:06,383
Anytime you're trying to determine, hm,

808
00:34:06,385 --> 00:34:07,551
what's my model?

809
00:34:07,553 --> 00:34:09,303
You always want to think,

810
00:34:09,304 --> 00:34:11,054
what does this thing do, what does it operate on?

811
00:34:11,056 --> 00:34:12,588
That's usually gonna be its model.

812
00:34:12,590 --> 00:34:15,725
Okay, either how it functions or what it operates on,

813
00:34:15,727 --> 00:34:18,293
that's usually gonna be the model, all right.

814
00:34:18,295 --> 00:34:19,628
So this thing edits a waypoint, so

815
00:34:19,630 --> 00:34:24,899
that's going to be its model.

816
00:34:24,901 --> 00:34:28,736
So now, let's get some more space here.

817
00:34:28,738 --> 00:34:32,773
Let's keep our view and model in sync, okay.

818
00:34:32,775 --> 00:34:34,808
One of the first things we want to do actually when we

819
00:34:34,810 --> 00:34:37,344
put a model in or add view is keep them in sync, so

820
00:34:37,346 --> 00:34:40,346
that they're always reflecting each other.

821
00:34:40,348 --> 00:34:45,117
So let's do that by having here, a div set

822
00:34:45,119 --> 00:34:50,221
on the model that calls some update UI thing, okay.

823
00:34:50,223 --> 00:34:54,258
And we'll do the exact same thing down here, as well.

824
00:34:54,260 --> 00:34:56,927
So if you set either text field,

825
00:34:56,929 --> 00:35:00,664
we're going to update the model.

826
00:35:00,666 --> 00:35:03,967
What did I do wrong here, oh I don't have updateUI.

827
00:35:03,969 --> 00:35:09,672
Okay, so let's go ahead and, func updateUI.

828
00:35:09,674 --> 00:35:13,108
So we've got an updateUI, what do we need to do in updateUI?

829
00:35:13,110 --> 00:35:15,677
Really, we just need to update our text fields from our

830
00:35:15,679 --> 00:35:17,996
waypoints.

831
00:35:17,997 --> 00:35:20,314
So I'm gonna say, nameTextField.text

832
00:35:20,316 --> 00:35:24,685
= waypointToEdit.name, and

833
00:35:24,687 --> 00:35:32,359
the infoTextField.text = waypointToEdit.info.

834
00:35:32,361 --> 00:35:33,993
Okay, so that's it.

835
00:35:33,995 --> 00:35:38,064
Let's also update our UI in viewDidLoad, that way,

836
00:35:38,066 --> 00:35:41,633
if our model got set before our outlets were loaded,

837
00:35:41,635 --> 00:35:44,803
this will catch them up to speed, okay.

838
00:35:44,805 --> 00:35:48,273
So it's a very common pattern, here, to updateUI

839
00:35:48,275 --> 00:35:51,209
when your model changes and also update in viewDidLoad.

840
00:35:51,211 --> 00:35:55,146
Okay, because remember outlets are not set, unfortunately,

841
00:35:55,148 --> 00:35:58,382
sometimes during prepare for segue, for example.

842
00:35:58,384 --> 00:36:01,685
okay, so let's see what this looks like.

843
00:36:01,687 --> 00:36:04,320
I'm actually gonna run this one on

844
00:36:04,322 --> 00:36:06,823
the phone because I wanna show you

845
00:36:06,825 --> 00:36:10,626
a particular problem we have with this UI so far.

846
00:36:15,432 --> 00:36:17,098
Okay, let me put this on the screen here.

847
00:36:24,207 --> 00:36:27,841
Okay, so here's our UI, I'm gonna just tap and

848
00:36:27,843 --> 00:36:32,612
hold to drop here, okay, and now I'm gonna click on it.

849
00:36:32,614 --> 00:36:35,515
I'm gonna press our new editing button and

850
00:36:35,517 --> 00:36:37,016
here we have our UI.

851
00:36:37,018 --> 00:36:38,584
That's good our UI's appearing.

852
00:36:38,586 --> 00:36:42,220
A couple of problems here, one, no keyboard.

853
00:36:42,222 --> 00:36:43,955
Okay, our UI has appeared here, but

854
00:36:43,957 --> 00:36:45,957
if there's not keyboard that's not so good, but

855
00:36:45,959 --> 00:36:49,093
if I touch on a text field it appears.

856
00:36:49,095 --> 00:36:50,494
Okay, that's kind of good except for

857
00:36:50,496 --> 00:36:53,296
when my the thing first comes up I probably want it to

858
00:36:53,298 --> 00:36:55,465
have a keyboard.

859
00:36:55,466 --> 00:36:57,633
So we're going to put in some code to become first responder

860
00:36:57,636 --> 00:36:59,635
on one of those text fields, okay.

861
00:36:59,637 --> 00:37:01,003
Right off the bat.

862
00:37:01,005 --> 00:37:02,204
Another problem is,

863
00:37:02,206 --> 00:37:04,673
I can never make this keyboard go away, okay.

864
00:37:04,675 --> 00:37:07,442
No matter what I press, I press return, click on

865
00:37:07,444 --> 00:37:10,411
[INAUDIBLE], and I can't make it go away, that's a problem.

866
00:37:10,413 --> 00:37:14,081
Now, I don't have anything down at the bottom right now,

867
00:37:14,083 --> 00:37:17,184
but when we start having an image in our waypoint editor,

868
00:37:17,186 --> 00:37:18,952
then it's gonna cover up that image.

869
00:37:18,954 --> 00:37:20,553
We need a way for

870
00:37:20,555 --> 00:37:23,690
the return key on the keyboard that I'm pressing down here,

871
00:37:23,692 --> 00:37:26,759
to make these things resign first responder, okay.

872
00:37:26,761 --> 00:37:32,564
Let's fix those things really quickly, they're easy to fix.

873
00:37:33,867 --> 00:37:36,167
Become first responder, we can just do in viewDidLoad.

874
00:37:36,169 --> 00:37:39,737
I'm just gonna say, name text field become first responder,

875
00:37:39,739 --> 00:37:42,573
so as soon as this thing is created it's gonna immediately

876
00:37:42,575 --> 00:37:46,309
make that text field be the first responder, okay?

877
00:37:46,311 --> 00:37:47,844
So that's easy.

878
00:37:47,846 --> 00:37:52,648
Making the return key resign first responder requires us

879
00:37:52,650 --> 00:37:57,452
to, if you remember from last time, become UI text field

880
00:37:57,454 --> 00:38:02,456
delegates, and implement this method, text field should

881
00:38:02,458 --> 00:38:07,494
end editing or should end return, here it is, okay.

882
00:38:07,496 --> 00:38:08,962
So here,

883
00:38:08,964 --> 00:38:12,565
when a text field hits the return key, I'm going to say

884
00:38:12,567 --> 00:38:14,867
textField.resignFirstRespon- der.

885
00:38:16,203 --> 00:38:20,138
And then we'll let it do whatever it normally does.

886
00:38:20,140 --> 00:38:22,307
Okay, so that solves both of those problems.

887
00:38:23,343 --> 00:38:25,676
Oh, whoops, one quick thing we need to do before

888
00:38:25,678 --> 00:38:27,411
we do that is,

889
00:38:27,413 --> 00:38:30,747
if we're gonna have this text field delegate method called,

890
00:38:30,749 --> 00:38:35,351
we need to obviously make, oh, I did this totally wrong.

891
00:38:35,353 --> 00:38:36,652
Sorry.

892
00:38:36,653 --> 00:38:37,952
This should be, nobody caught me on this, but

893
00:38:37,955 --> 00:38:39,788
this should be on the model, okay.

894
00:38:39,790 --> 00:38:41,857
Add those on the text fields.

895
00:38:41,859 --> 00:38:43,391
All right, it's the model that wants

896
00:38:43,393 --> 00:38:46,227
to update the UI not the text fields, okay?

897
00:38:46,229 --> 00:38:49,130
What the text fields want when they're didSet

898
00:38:49,132 --> 00:38:54,668
is they want to set their delegates equal to self.

899
00:38:54,670 --> 00:38:58,438
That's what they wanna do, okay.

900
00:38:58,440 --> 00:38:59,839
Guys, pay attention.

901
00:38:59,841 --> 00:39:02,508
I count on you guys to catch me doing these things.

902
00:39:02,510 --> 00:39:04,042
Okay, everyone understand that?

903
00:39:04,044 --> 00:39:07,078
The model setting that wants to update the UI, the text

904
00:39:07,080 --> 00:39:10,281
field, just want to set themselves as the delegate.

905
00:39:10,283 --> 00:39:12,383
See, you let me do another thing here.

906
00:39:13,352 --> 00:39:15,185
Okay, there we go.

907
00:39:15,186 --> 00:39:17,019
So now both text fields have self as their delegate, so

908
00:39:17,022 --> 00:39:20,290
they're both going to call ShouldReturn, okay.

909
00:39:20,292 --> 00:39:22,258
So let's try that.

910
00:39:29,367 --> 00:39:32,801
Are we still up there, yes.

911
00:39:32,803 --> 00:39:35,337
Okay. Again, here I'm gonna add one.

912
00:39:35,339 --> 00:39:36,505
Click here.

913
00:39:36,506 --> 00:39:37,672
Let's bring up our new MVC.

914
00:39:37,674 --> 00:39:38,890
Here is is.

915
00:39:38,891 --> 00:39:40,107
Keyboard comes up, excellent.

916
00:39:40,109 --> 00:39:42,476
And if I hit Return, keyboard goes away.

917
00:39:42,478 --> 00:39:44,011
And if I go to Back, it comes back.

918
00:39:44,013 --> 00:39:45,478
So that's much more control.

919
00:39:45,480 --> 00:39:48,014
And if you're doing this in the simulator, it seems like,

920
00:39:48,016 --> 00:39:49,566
oh, this is all great.

921
00:39:49,567 --> 00:39:51,117
But then when you run it on the device, you're like, oh,

922
00:39:51,119 --> 00:39:52,551
well that's not very useable, okay.

923
00:39:52,553 --> 00:39:55,487
So you've got to be careful to make sure things actually

924
00:39:55,489 --> 00:39:56,888
are useable on the device.

925
00:39:56,890 --> 00:39:58,589
All right.

926
00:39:58,591 --> 00:40:02,893
That's that, so now we've kind of set up our UI.

927
00:40:02,895 --> 00:40:04,928
But actually, there's one other problem with this.

928
00:40:04,930 --> 00:40:07,230
Let's go ahead and take a look at this other problem we got.

929
00:40:11,469 --> 00:40:15,404
Which is when I add a thing here is I might type in

930
00:40:15,406 --> 00:40:19,974
the name, like I think I put that pin on the golf course

931
00:40:19,976 --> 00:40:21,843
there or something.

932
00:40:21,845 --> 00:40:23,577
Right?

933
00:40:23,579 --> 00:40:31,218
Golf course, okay, snowed, whatever.

934
00:40:31,220 --> 00:40:33,186
But now there's no way for me to get back.

935
00:40:33,188 --> 00:40:34,554
[LAUGH].

936
00:40:34,556 --> 00:40:35,321
You see?

937
00:40:35,323 --> 00:40:37,340
How can I get back?

938
00:40:37,341 --> 00:40:39,358
I've changed the things I want, now I want to get back,

939
00:40:39,360 --> 00:40:40,792
I want to dismiss this thing and

940
00:40:40,794 --> 00:40:45,830
get back, so we need some user interface here to get back.

941
00:40:45,832 --> 00:40:48,799
The other thing is, when we make changes in these text

942
00:40:48,801 --> 00:40:52,536
fields, it's not actually changing the waypoint, okay?

943
00:40:52,538 --> 00:40:54,805
So we need you to fix both those things.

944
00:40:54,807 --> 00:40:57,140
So let's fix the changing in the way point.

945
00:40:57,142 --> 00:40:59,742
Now, this one I'm gonna use notifications for.

946
00:40:59,744 --> 00:41:01,177
Because I want to show you a little bit more

947
00:41:01,179 --> 00:41:03,345
about notifications that we really didn't cover

948
00:41:03,347 --> 00:41:05,681
when we did the notifications last time.

949
00:41:05,683 --> 00:41:09,851
So, text fields it turns out, they have a notification.

950
00:41:09,853 --> 00:41:11,986
Okay, in fact they have a couple of notifications.

951
00:41:11,988 --> 00:41:13,687
Three notifications, I think, even.

952
00:41:13,689 --> 00:41:16,757
But one of them is ui text field,

953
00:41:16,759 --> 00:41:19,325
text did change notification.

954
00:41:19,327 --> 00:41:22,095
So you can sign up to hear from a text field whenever its

955
00:41:22,097 --> 00:41:23,462
text changes.

956
00:41:23,464 --> 00:41:25,130
Now, that's gonna be really valuable for us, here.

957
00:41:25,132 --> 00:41:27,532
Because whenever the text field's text changes,

958
00:41:27,534 --> 00:41:29,734
we can update our wave point.

959
00:41:29,736 --> 00:41:30,435
Right?

960
00:41:30,437 --> 00:41:31,936
So, how do we do that?

961
00:41:31,938 --> 00:41:34,438
How do we make that work?

962
00:41:34,439 --> 00:41:36,939
Well, turns out we want to put this in viewDidappear, so

963
00:41:36,942 --> 00:41:40,677
in viewDidappear, okay, super.viewDidappear.

964
00:41:42,881 --> 00:41:45,214
I'm just gonna call a method here,

965
00:41:45,216 --> 00:41:48,116
called observe text fields.

966
00:41:49,353 --> 00:41:51,803
Okay?

967
00:41:51,804 --> 00:41:54,254
In an observed text fields, I am going to set myself up

968
00:41:54,257 --> 00:41:59,660
to observe changes made in those text fields.

969
00:41:59,662 --> 00:42:01,512
All right?

970
00:42:01,513 --> 00:42:03,363
And, so I'm gonna do that with the notification center, so

971
00:42:03,365 --> 00:42:06,399
I'm gonna get my center, which is NS Notification center.

972
00:42:06,401 --> 00:42:08,234
Default center.

973
00:42:08,236 --> 00:42:11,437
I'm also going to specify the queue I want this on which is,

974
00:42:11,439 --> 00:42:14,606
of course, the main queue, so I'm gonna say, main queue.

975
00:42:15,642 --> 00:42:18,610
And them I'm just gonna say, use that thing we had before,

976
00:42:18,612 --> 00:42:22,347
Center Add Observer, for name which is this.

977
00:42:22,349 --> 00:42:26,183
And the name of this notification is UI Text Field.

978
00:42:26,185 --> 00:42:32,622
TextDidChangeNotification.

979
00:42:32,624 --> 00:42:34,858
'Kay?

980
00:42:34,859 --> 00:42:37,093
So, so far, this notification is nothing new to you.

981
00:42:37,095 --> 00:42:40,196
Object is the object I care about if it changes,

982
00:42:40,198 --> 00:42:43,499
which is, let's say, the name text field, in this case.

983
00:42:43,501 --> 00:42:46,101
'Kay?

984
00:42:46,102 --> 00:42:48,702
Queue is the queue, and the block, okay, I'm gonna do the.

985
00:42:48,705 --> 00:42:50,104
Our magic trick here of

986
00:42:50,106 --> 00:42:53,274
closing off the end of that, I'll get rid of that.

987
00:42:53,276 --> 00:42:55,476
And then put our block on the end here.

988
00:42:55,478 --> 00:42:59,379
So here are the argument, I'll just call it notification.

989
00:42:59,381 --> 00:43:01,981
That's the notification that cames back, coming back.

990
00:43:01,983 --> 00:43:06,085
And all I wanna do here is if I can let waypoint,

991
00:43:06,087 --> 00:43:09,855
equal our waypoint to edit.

992
00:43:09,857 --> 00:43:12,591
Okay, so we can get our waypoint.

993
00:43:12,593 --> 00:43:16,794
Then, I'm just going to set the waypoint's name

994
00:43:16,796 --> 00:43:21,031
equal to the name text field's text.

995
00:43:21,033 --> 00:43:24,901
So every time the name text field changes here,

996
00:43:24,903 --> 00:43:26,770
I'm just going to update the name of our waypoint.

997
00:43:26,772 --> 00:43:28,538
And exactly the same for the info.

998
00:43:30,141 --> 00:43:32,708
So all we have to change here is

999
00:43:32,710 --> 00:43:34,676
info text fields coming in here.

1000
00:43:34,678 --> 00:43:36,644
And this is going to be updated to info.

1001
00:43:36,646 --> 00:43:38,913
And this is the info.

1002
00:43:40,349 --> 00:43:41,715
Now so far, so good.

1003
00:43:41,717 --> 00:43:43,616
You're probably like oh, okay it makes sense.

1004
00:43:43,618 --> 00:43:45,718
You haven't taught us anything new about notification.

1005
00:43:45,720 --> 00:43:47,420
But there's a very important piece of this

1006
00:43:47,422 --> 00:43:48,987
puzzle right here.

1007
00:43:48,989 --> 00:43:52,691
What happens when this MBC gets dismissed?

1008
00:43:53,927 --> 00:43:57,328
These observers are still trying to observe

1009
00:43:57,330 --> 00:43:59,363
those text fields.

1010
00:43:59,364 --> 00:44:01,397
Even those text fields could be have gone away,

1011
00:44:01,400 --> 00:44:03,200
they won't because these closures are gonna keep

1012
00:44:03,202 --> 00:44:04,801
those text fields in memory.

1013
00:44:04,803 --> 00:44:06,402
And also, self can never go away because

1014
00:44:06,404 --> 00:44:08,704
these closures are gonna be keep self in memory.

1015
00:44:08,706 --> 00:44:12,241
So this is a problem, so when you add an observer like this

1016
00:44:12,243 --> 00:44:14,509
and your NVCs ever going to go away,

1017
00:44:14,511 --> 00:44:18,780
which our last NVC never went away, it was the root NVC so

1018
00:44:18,782 --> 00:44:20,581
we added that observer for a name.

1019
00:44:20,583 --> 00:44:22,616
We probably could just leave it there forever,

1020
00:44:22,618 --> 00:44:23,850
because it's never going to go away.

1021
00:44:23,852 --> 00:44:25,552
Although good design,

1022
00:44:25,553 --> 00:44:27,253
maybe even that one would know how to go away.

1023
00:44:27,255 --> 00:44:28,755
But how do we go away?

1024
00:44:28,757 --> 00:44:33,692
And the answer is that this returns a little cookie, okay?

1025
00:44:33,694 --> 00:44:34,726
So it returns a cookie.

1026
00:44:34,728 --> 00:44:36,661
I'm gonna make storage for these two cookies.

1027
00:44:36,663 --> 00:44:40,931
One I'm gonna call it the name text field observer, and

1028
00:44:40,933 --> 00:44:44,001
it's a type NSObjectProtocol.

1029
00:44:44,003 --> 00:44:46,870
So NSObjectProtocol just means it's something

1030
00:44:46,872 --> 00:44:49,305
that used to be an NS object in the old world.

1031
00:44:49,307 --> 00:44:50,807
Okay, in the old, objective C world.

1032
00:44:50,809 --> 00:44:52,475
That's all that means for an NS object protocol.

1033
00:44:52,477 --> 00:44:53,943
We don't even know,

1034
00:44:53,944 --> 00:44:55,410
we don't care what's in the NS object protocol for

1035
00:44:55,413 --> 00:44:59,247
the purposes of this, because really, this is just a cookie.

1036
00:44:59,249 --> 00:45:02,417
It's just something that it gives us that we can give back

1037
00:45:02,419 --> 00:45:05,353
to it when we wanna talk about this thing.

1038
00:45:05,355 --> 00:45:06,887
So, here's this observer,

1039
00:45:06,889 --> 00:45:11,725
and I'm gonna say here NTF observer equals that.

1040
00:45:11,727 --> 00:45:15,662
I'm gonna say ITF observer equals that.

1041
00:45:15,664 --> 00:45:18,698
So I've added these observers and I got this cookie back.

1042
00:45:18,700 --> 00:45:21,033
Now, when I'm done observing,

1043
00:45:21,035 --> 00:45:24,636
I need to remove this cookie from the notification center.

1044
00:45:24,638 --> 00:45:28,640
So I'm gonna do that in view will disappear.

1045
00:45:29,576 --> 00:45:33,310
Okay, so, when my view will disappear, okay?

1046
00:45:33,312 --> 00:45:36,146
I don't need to look at those text fields anymore after I've

1047
00:45:36,148 --> 00:45:38,048
gone off screen.

1048
00:45:38,049 --> 00:45:39,949
They can't be changing because I'm not even on screen

1049
00:45:39,952 --> 00:45:41,084
right now.

1050
00:45:41,086 --> 00:45:42,786
I'm just gonna say

1051
00:45:42,787 --> 00:45:44,487
NS Notification Center default Center.

1052
00:45:44,489 --> 00:45:47,523
Actually, let's check and make sure they're not nill because

1053
00:45:47,525 --> 00:45:50,125
see I made these fields optional, so we'll say if.

1054
00:45:50,127 --> 00:45:54,262
Observer if let, let observer equal

1055
00:45:54,264 --> 00:45:58,232
the mean text field observer, than notification center.

1056
00:46:02,371 --> 00:46:03,771
Remove that observer.

1057
00:46:03,772 --> 00:46:05,172
So you can see how I've never had to actually look inside

1058
00:46:05,174 --> 00:46:08,208
and see what this thing is, I don't send it any messages,

1059
00:46:08,210 --> 00:46:11,778
I just get the cookie here and then I pass it along in here.

1060
00:46:11,780 --> 00:46:14,046
Except for this is observer, because I've lighted it.

1061
00:46:14,048 --> 00:46:16,315
Okay, so that's all we had to do.

1062
00:46:16,317 --> 00:46:17,766
Same thing here.

1063
00:46:17,767 --> 00:46:19,216
We'll do the same thing with the other cookie.

1064
00:46:19,219 --> 00:46:23,455
This is the ITF observer, info text field.

1065
00:46:23,457 --> 00:46:28,559
So this pattern by the way, of starting to observe something

1066
00:46:28,561 --> 00:46:31,495
in view did appear, and then stopping observing from it in

1067
00:46:31,497 --> 00:46:33,730
view will disappear is a very common way to do this.

1068
00:46:34,900 --> 00:46:38,001
Okay, because usually, any notifications like keyboard

1069
00:46:38,003 --> 00:46:40,870
will change, or something like that, there's keyboard will

1070
00:46:40,872 --> 00:46:42,971
appear, you don't care about that if you're not on screen.

1071
00:46:42,973 --> 00:46:45,273
So there's a perfect place to add and remove this.

1072
00:46:45,275 --> 00:46:49,010
Does everyone understand what's going on here?

1073
00:46:49,012 --> 00:46:50,445
You add to these notifications so

1074
00:46:50,447 --> 00:46:51,846
every time it checks changes,

1075
00:46:51,848 --> 00:46:53,280
it's gonna update our way point, but

1076
00:46:53,282 --> 00:46:55,749
we don't wanna be doing that when we're not on screen.

1077
00:46:55,751 --> 00:46:57,917
And we don't wanna have these closures,

1078
00:46:57,919 --> 00:47:00,687
this closure right here, and this closure right here.

1079
00:47:00,689 --> 00:47:04,690
We don't want them keeping self, and this text field

1080
00:47:04,692 --> 00:47:07,793
through self, we don't want them keeping them in heap.

1081
00:47:07,795 --> 00:47:09,194
When we, when our NBC goes away,

1082
00:47:09,196 --> 00:47:11,396
we want it to go completely away, out of the heap.

1083
00:47:13,066 --> 00:47:14,832
All right. So that's notification.

1084
00:47:14,834 --> 00:47:16,633
That's your little DL notification code.

1085
00:47:16,635 --> 00:47:18,568
Now let's fix that other problem,

1086
00:47:18,570 --> 00:47:21,637
the problem where there's no way to dismiss the thing.

1087
00:47:21,639 --> 00:47:23,572
It comes up and we can't dismiss it.

1088
00:47:23,574 --> 00:47:25,007
And there's a number of ways we could do that.

1089
00:47:25,009 --> 00:47:28,043
We could put a little Done button down in the middle

1090
00:47:28,045 --> 00:47:29,778
somewhere of that UI.

1091
00:47:29,780 --> 00:47:34,982
But actually, I'm going to do it by putting this

1092
00:47:34,984 --> 00:47:39,219
user interface in an navigation controller.

1093
00:47:39,221 --> 00:47:41,354
Now, why am I gonna put it in navigation controller?

1094
00:47:41,356 --> 00:47:43,106
Two reasons.

1095
00:47:43,107 --> 00:47:44,857
One, users are used to the look of navigation controllers

1096
00:47:44,859 --> 00:47:47,827
being the title bars and maybe there are buttons up there, so

1097
00:47:47,829 --> 00:47:49,728
it's a good place to put a Done button.

1098
00:47:49,730 --> 00:47:52,164
Also, it gives me a title, okay?

1099
00:47:52,166 --> 00:47:53,632
When this thing came up and

1100
00:47:53,633 --> 00:47:55,099
it was just a blank screen with these two fields,

1101
00:47:55,102 --> 00:47:56,367
it's a little disconcerting.

1102
00:47:56,369 --> 00:47:58,219
What's happening?

1103
00:47:58,220 --> 00:48:00,070
Whereas, if I have a title on top, like, Edit Waypoint,

1104
00:48:00,073 --> 00:48:02,306
it'll be clear what the heck is going on.

1105
00:48:02,308 --> 00:48:05,142
So I'm just gonna select this, right here, and

1106
00:48:05,144 --> 00:48:09,012
do Embed In Navigation Controller.

1107
00:48:09,014 --> 00:48:10,246
'Kay? So

1108
00:48:10,247 --> 00:48:11,479
it puts a Navigation Controller.

1109
00:48:11,482 --> 00:48:15,617
Now, I can, for example, put a title, Edit Waypoint, in here.

1110
00:48:15,619 --> 00:48:17,886
And, also, I can have a Done button here.

1111
00:48:17,888 --> 00:48:21,822
So let's go ahead and put a Done button in there.

1112
00:48:21,824 --> 00:48:24,591
Down here to Bar Button Item.

1113
00:48:24,593 --> 00:48:26,326
Here's a Bar Button Item.

1114
00:48:26,328 --> 00:48:27,861
We'll put it right here.

1115
00:48:27,863 --> 00:48:29,095
We'll call it Done.

1116
00:48:29,097 --> 00:48:32,898
And then let's go ahead and wire that Done button up.

1117
00:48:32,900 --> 00:48:34,433
Okay. We'll wire it

1118
00:48:34,435 --> 00:48:36,334
up at the top here, I guess.

1119
00:48:36,336 --> 00:48:40,171
Just Ctrl+drag from this right in here.

1120
00:48:40,173 --> 00:48:43,607
And, so when we hit Done, all we're going to do is dismiss.

1121
00:48:43,609 --> 00:48:45,743
So this is just going to be an action,

1122
00:48:45,745 --> 00:48:48,845
bar button item action, we'll call it done.

1123
00:48:48,847 --> 00:48:51,014
And, inside this Done, right here.

1124
00:48:51,016 --> 00:48:53,482
Sorry, we're going to go back to wide.

1125
00:48:54,652 --> 00:48:56,368
Okay?

1126
00:48:56,369 --> 00:48:58,085
Inside this done action when the done button is pressed,

1127
00:48:58,088 --> 00:49:00,555
I'm just going to say presenting

1128
00:49:00,557 --> 00:49:02,590
view controller.dismiss.

1129
00:49:02,592 --> 00:49:04,291
Okay? So, dismiss,

1130
00:49:06,228 --> 00:49:10,430
I'm asking the presenting view controller who presented me,

1131
00:49:10,432 --> 00:49:12,665
please dismiss whoever you just presented.

1132
00:49:12,667 --> 00:49:16,335
And, in fact, if my presenting view controller has presented

1133
00:49:16,337 --> 00:49:18,904
me and I've presented someone else, when I do this dismiss,

1134
00:49:18,906 --> 00:49:20,238
it's going to dismiss all of us.

1135
00:49:21,241 --> 00:49:21,806
Okay?

1136
00:49:23,042 --> 00:49:25,142
So, yes, we do want to animate it and, no,

1137
00:49:25,144 --> 00:49:28,912
we don't want to find out when the dismiss happens, okay?

1138
00:49:30,949 --> 00:49:32,332
Okay. So that's it.

1139
00:49:32,333 --> 00:49:33,716
So that done button will allow us to dismiss.

1140
00:49:35,219 --> 00:49:36,184
All right. So, let's take a look,

1141
00:49:37,187 --> 00:49:38,919
see if we fixed those two problems.

1142
00:49:41,757 --> 00:49:44,391
And we only have one more piece to go to wire this up

1143
00:49:44,393 --> 00:49:45,025
after this.

1144
00:49:47,429 --> 00:49:48,945
All right.

1145
00:49:48,946 --> 00:49:50,462
So, we're going to add, along with the long press,

1146
00:49:50,465 --> 00:49:52,464
I'm gonna click, I'm gonna edit it.

1147
00:49:52,466 --> 00:49:54,383
Here it is.

1148
00:49:54,384 --> 00:49:56,301
Notice now I have this nice title, Edit Waypoint.

1149
00:49:56,303 --> 00:50:00,138
I can set this to be again, golf or something.

1150
00:50:00,140 --> 00:50:02,840
I'm not gonna type too much because it's not gonna work

1151
00:50:02,842 --> 00:50:05,009
and you're going to see why in a moment.

1152
00:50:05,011 --> 00:50:06,176
But here it is.

1153
00:50:06,178 --> 00:50:07,511
Okay. We have this, we can return.

1154
00:50:07,513 --> 00:50:08,946
This is great.

1155
00:50:08,947 --> 00:50:10,380
Our NBC's exactly what we want.

1156
00:50:10,382 --> 00:50:11,681
Now, I'm gonna hit Done.

1157
00:50:11,683 --> 00:50:13,049
It dismisses it.

1158
00:50:13,051 --> 00:50:16,718
Now, let's look and oh, it still says Dropped.

1159
00:50:16,720 --> 00:50:18,153
Okay? Why is that?

1160
00:50:18,155 --> 00:50:21,255
That's because we didn't prepare that segue.

1161
00:50:21,257 --> 00:50:22,390
Okay?

1162
00:50:22,391 --> 00:50:23,524
And modal segue is like any other segue,

1163
00:50:23,526 --> 00:50:25,309
if you don't prepare it,

1164
00:50:25,310 --> 00:50:27,093
it's going to not going to know what it's working on.

1165
00:50:27,096 --> 00:50:30,263
So we need to set each modal, which is the waypoint to edit

1166
00:50:30,265 --> 00:50:33,166
and we do that in prepare for segue.

1167
00:50:33,168 --> 00:50:34,300
We already have a prepare for

1168
00:50:34,302 --> 00:50:37,069
segue in our GPX view controller right here.

1169
00:50:37,071 --> 00:50:40,439
Prepares for the image viewing 1, so

1170
00:50:40,441 --> 00:50:44,509
we just need to put another else if the segue's

1171
00:50:44,511 --> 00:50:48,913
identifier equals our new EditWaypointSegue.

1172
00:50:50,316 --> 00:50:51,632
Okay?

1173
00:50:51,633 --> 00:50:52,949
And in here, what do we need to do?

1174
00:50:52,951 --> 00:50:56,786
Again, just like any other one, we need to get the thing

1175
00:50:56,788 --> 00:50:59,956
we're pointing to, that we're segueing to and set it up.

1176
00:50:59,958 --> 00:51:05,828
So we're going to say if the, I'll go, what did I call it,

1177
00:51:05,830 --> 00:51:08,296
EWVC, okay, EditWaypointViewController.

1178
00:51:08,298 --> 00:51:12,400
If we can let the EditWaypointViewController

1179
00:51:12,402 --> 00:51:15,770
equal the segue's destination as and

1180
00:51:15,772 --> 00:51:18,772
EditWaypointViewController.

1181
00:51:20,709 --> 00:51:24,677
Okay, then now we've got this Edit Way View Controller.

1182
00:51:24,679 --> 00:51:27,880
We can set the EditWaypointViewControllers,

1183
00:51:27,882 --> 00:51:30,549
way point to edit equal to a way point.

1184
00:51:30,551 --> 00:51:32,484
So, we need to get our waypoint,

1185
00:51:32,486 --> 00:51:34,152
which I'm actually gonna steal from right here,

1186
00:51:34,154 --> 00:51:36,354
because we already have a nice line of code that does that.

1187
00:51:40,726 --> 00:51:41,408
Okay.

1188
00:51:41,409 --> 00:51:42,091
So there's our waypoint.

1189
00:51:43,461 --> 00:51:47,162
Now this, oh, sorry, this also.

1190
00:51:47,164 --> 00:51:48,764
Notice this is complaining.

1191
00:51:48,766 --> 00:51:50,949
See, this says error.

1192
00:51:50,950 --> 00:51:53,133
I'm trying to set the waypoint to edit to waypoint and

1193
00:51:53,136 --> 00:51:57,638
it's saying GPX waypoint is not an editable waypoint.

1194
00:51:57,640 --> 00:51:59,340
Ah-hah.

1195
00:51:59,342 --> 00:52:01,775
Because we declared Waypoint Edit to be an editable

1196
00:52:01,777 --> 00:52:03,910
waypoint, which is good, because it edits it, so

1197
00:52:03,912 --> 00:52:06,096
it better be.

1198
00:52:06,097 --> 00:52:08,281
And this is a GPX Waypoint, cuz I copied this line of code

1199
00:52:08,283 --> 00:52:11,417
from up here, where we're looking at the image URL.

1200
00:52:11,419 --> 00:52:13,419
So really easy fix, though,

1201
00:52:13,421 --> 00:52:17,922
we'll just set this to be an editable waypoint.

1202
00:52:17,924 --> 00:52:19,257
'Kay?

1203
00:52:19,259 --> 00:52:21,058
Now, this code will not work.

1204
00:52:22,194 --> 00:52:25,228
Any sharp-eyed people know why this won't work.

1205
00:52:25,230 --> 00:52:27,930
It's a problem we've had in other prepare for segues.

1206
00:52:29,967 --> 00:52:31,167
>> Navigation.

1207
00:52:31,168 --> 00:52:32,368
>> Bingo. Bonus points over there.

1208
00:52:32,370 --> 00:52:35,704
If I wereAron, I'd be throwing candy at you at this point.

1209
00:52:35,706 --> 00:52:37,289
Yes.

1210
00:52:37,290 --> 00:52:38,873
That editable waypoint view controller is

1211
00:52:38,875 --> 00:52:40,741
inside a navigation controller.

1212
00:52:40,743 --> 00:52:43,277
So the destination view controller is gonna be

1213
00:52:43,279 --> 00:52:44,711
that navigation controller.

1214
00:52:44,713 --> 00:52:47,447
So this is not gonna work, cuz this is gonna fail,

1215
00:52:47,449 --> 00:52:48,748
this as Waypoint finish.

1216
00:52:48,750 --> 00:52:50,816
Now, we've dealt with this in the past,

1217
00:52:50,818 --> 00:52:53,052
by putting a little if here, whatever.

1218
00:52:53,054 --> 00:52:55,387
It's so common to want to do that,

1219
00:52:55,389 --> 00:52:59,357
that actually I usually add an extension

1220
00:52:59,359 --> 00:53:02,393
to UIViewController that does that.

1221
00:53:02,395 --> 00:53:04,461
I call it content view controller, and

1222
00:53:04,463 --> 00:53:07,964
all it says is if I'm a navigation controller,

1223
00:53:07,966 --> 00:53:10,400
then return my visible view controller.

1224
00:53:10,402 --> 00:53:11,834
Otherwise return myself.

1225
00:53:13,237 --> 00:53:14,236
Okay.

1226
00:53:14,238 --> 00:53:15,604
So this is a nice little trick.

1227
00:53:15,606 --> 00:53:18,073
You can now, I can send to any view controller,

1228
00:53:18,075 --> 00:53:20,174
give me the content view controller.

1229
00:53:20,176 --> 00:53:21,542
If you are the content view controller,

1230
00:53:21,544 --> 00:53:22,810
you just give me yourself.

1231
00:53:22,812 --> 00:53:23,910
If you're a navigation controller,

1232
00:53:23,912 --> 00:53:26,146
then you give me the visible view controller.

1233
00:53:26,148 --> 00:53:28,648
So this is a really nice little extension to throw in

1234
00:53:28,650 --> 00:53:32,351
all your apps that are segueing to things that might

1235
00:53:32,353 --> 00:53:34,887
or might not be in navigation controllers.

1236
00:53:34,889 --> 00:53:39,557
So I use this by saying destinationViewController.con-

1237
00:53:39,559 --> 00:53:41,626
tentViewController.

1238
00:53:41,628 --> 00:53:43,127
'Kay?

1239
00:53:43,128 --> 00:53:44,627
Cuz I added this var to all view controllers.

1240
00:53:44,630 --> 00:53:46,063
In fact, I can do the same thing up here.

1241
00:53:47,166 --> 00:53:49,065
With this one, okay, our image one.

1242
00:53:49,067 --> 00:53:53,536
So, if we ever put our image, if we were ever transitioning

1243
00:53:53,538 --> 00:53:56,105
to show the image and it wrapped in a view controller,

1244
00:53:56,107 --> 00:53:57,639
we could do that as well.

1245
00:53:57,641 --> 00:54:00,442
So I almost put this in all of my

1246
00:54:00,444 --> 00:54:01,976
destination view controller segues.

1247
00:54:01,978 --> 00:54:03,844
Why not? Doesn't hurt, okay.

1248
00:54:05,214 --> 00:54:05,946
All right.

1249
00:54:05,948 --> 00:54:07,113
So now this will work.

1250
00:54:07,115 --> 00:54:08,381
Let's go ahead and run.

1251
00:54:19,026 --> 00:54:24,963
Okay, we add, we click, we edit, we go here.

1252
00:54:24,965 --> 00:54:27,365
Oh, notice now it says dropped.

1253
00:54:27,367 --> 00:54:29,533
Because we prepared it, so

1254
00:54:29,535 --> 00:54:31,602
it knows that it's the one that said drop.

1255
00:54:31,604 --> 00:54:33,036
So I'm going to change this.

1256
00:54:33,038 --> 00:54:35,305
Now we'll put back in Golf Course.

1257
00:54:35,307 --> 00:54:37,974
It's worse typing it in now that it's going to work.

1258
00:54:37,976 --> 00:54:38,741
Course.

1259
00:54:39,744 --> 00:54:41,009
Okay. And then we could say it's

1260
00:54:41,011 --> 00:54:46,147
under the snow, which it was when.

1261
00:54:46,149 --> 00:54:47,415
From this trip.

1262
00:54:47,417 --> 00:54:49,016
Okay, so here we are.

1263
00:54:49,018 --> 00:54:50,650
We've got this, and we hit done.

1264
00:54:50,652 --> 00:54:54,220
And now when we look at our waypoint, it's edited it.'

1265
00:54:54,222 --> 00:54:55,221
Kay?

1266
00:54:55,223 --> 00:54:57,890
All right.

1267
00:54:57,892 --> 00:55:00,258
Now, let's look at something else.

1268
00:55:00,260 --> 00:55:03,328
What's this gonna look like on an iPad?

1269
00:55:03,330 --> 00:55:06,097
It looks great on iPhone, really nice, okay.

1270
00:55:06,099 --> 00:55:08,466
But, let's take a look at iPad.

1271
00:55:08,468 --> 00:55:09,667
See what that looks like.

1272
00:55:09,669 --> 00:55:11,601
So I have an iPad here.

1273
00:55:11,603 --> 00:55:12,936
It's going to run on that.

1274
00:55:22,880 --> 00:55:23,979
All right.

1275
00:55:23,981 --> 00:55:24,880
There we go. There's an iPad.

1276
00:55:24,882 --> 00:55:26,832
Here's Trax.

1277
00:55:26,833 --> 00:55:28,783
Now Trax is incredible on the iPad because

1278
00:55:29,952 --> 00:55:31,618
it's got such a big screen,

1279
00:55:31,620 --> 00:55:34,654
we can really see all of our stuff very clearly.

1280
00:55:34,656 --> 00:55:38,291
And especially if we click and want to look at an image.

1281
00:55:38,293 --> 00:55:41,361
Wow, we got this really nice screen loading it up here,

1282
00:55:41,363 --> 00:55:42,261
but, whoa, look at that.

1283
00:55:42,263 --> 00:55:43,596
So it's a gray.

1284
00:55:43,597 --> 00:55:44,930
So it's actually quite great.

1285
00:55:44,932 --> 00:55:48,833
This is quite a great thing on the iPad.

1286
00:55:48,835 --> 00:55:51,436
But there's a problem with the iPad.

1287
00:55:51,438 --> 00:55:52,303
Watch this.

1288
00:55:52,305 --> 00:55:53,671
Let's add.

1289
00:55:53,673 --> 00:55:54,338
Okay.

1290
00:55:54,340 --> 00:55:57,540
Click on Dropped > Edit.

1291
00:55:57,542 --> 00:56:01,711
And we've got this humongous thing.

1292
00:56:01,713 --> 00:56:05,314
I mean there's no way we would ever use that much screen real

1293
00:56:05,316 --> 00:56:06,782
estate, okay?

1294
00:56:06,784 --> 00:56:09,718
So that's really not an appropriate UI.

1295
00:56:09,720 --> 00:56:10,885
Listen to me carefully.

1296
00:56:10,887 --> 00:56:13,954
That's not an appropriate UI for an iPad, okay?

1297
00:56:13,956 --> 00:56:16,523
And I know that some of you, who were putting on your final

1298
00:56:16,525 --> 00:56:19,426
project, oh yeah for breadth, I'm supporting the iPad.

1299
00:56:19,428 --> 00:56:21,327
And all you're doing is doing it on iPhone and

1300
00:56:21,329 --> 00:56:22,628
then hoping that this is okay.

1301
00:56:22,630 --> 00:56:23,996
But this is not okay.

1302
00:56:23,998 --> 00:56:25,998
Okay? This does not look

1303
00:56:26,000 --> 00:56:27,633
on the iPad.

1304
00:56:27,634 --> 00:56:29,267
So if you're gonna say I support the iPad, don't try

1305
00:56:29,269 --> 00:56:31,703
and swing this one by us, cuz we're just not gonna buy it.

1306
00:56:31,705 --> 00:56:34,706
Okay, we're gonna write down, doesn't really support iPad.

1307
00:56:34,708 --> 00:56:38,208
All right, so how could we make this UI look more

1308
00:56:38,210 --> 00:56:39,476
iPad-esque?

1309
00:56:39,478 --> 00:56:40,844
Well, there's a couple things we can do.

1310
00:56:40,846 --> 00:56:44,347
One is, we could go back to our storyboard and

1311
00:56:44,349 --> 00:56:47,383
we can change the transition style,

1312
00:56:47,385 --> 00:56:50,786
'kay, of this particular segue way that we have down here.

1313
00:56:50,788 --> 00:56:52,287
Where is it?

1314
00:56:52,289 --> 00:56:54,756
It's over here.

1315
00:56:54,758 --> 00:56:55,390
Here it is.

1316
00:56:55,392 --> 00:56:59,093
If, we can change, it's still modal, but we can change this

1317
00:56:59,095 --> 00:57:01,862
presentation, for example, to be form sheet.

1318
00:57:01,864 --> 00:57:04,131
So form sheet, it's iPad only.

1319
00:57:04,133 --> 00:57:07,434
This will be ignored if you set this on an iPhone.

1320
00:57:07,436 --> 00:57:10,703
The form sheet looks like this, and

1321
00:57:10,705 --> 00:57:11,437
it's a little better.

1322
00:57:12,807 --> 00:57:13,905
It's not enough better for

1323
00:57:13,907 --> 00:57:16,341
your final project, but it's a little better.

1324
00:57:16,343 --> 00:57:18,743
So here's what it looks like.

1325
00:57:23,683 --> 00:57:25,849
All right, so I'm gonna add one here.

1326
00:57:25,851 --> 00:57:26,883
Click on it, edit it.

1327
00:57:26,885 --> 00:57:30,920
See the form sheet, at least it's smaller, okay?

1328
00:57:30,922 --> 00:57:32,388
So it's a little better.

1329
00:57:32,390 --> 00:57:33,655
It doesn't look too bad.

1330
00:57:33,657 --> 00:57:35,757
It's almost good enough.

1331
00:57:35,759 --> 00:57:38,960
But really what the iPad wants is for

1332
00:57:38,962 --> 00:57:41,963
that to be in a popover, right?

1333
00:57:41,965 --> 00:57:43,898
I wanna be able to go here.

1334
00:57:43,899 --> 00:57:45,832
And when I click this little thing, I want a small little

1335
00:57:45,835 --> 00:57:48,802
popover that just has the name and info field.

1336
00:57:48,804 --> 00:57:51,104
And if I have an image, make space for an image.

1337
00:57:51,106 --> 00:57:53,440
That's the perfect thing for an iPad, okay?

1338
00:57:53,442 --> 00:57:56,676
So let's turn this baby into a popover.

1339
00:57:56,678 --> 00:57:59,011
And that's gonna break the heck out of our iPhone one,

1340
00:57:59,013 --> 00:58:01,647
but we're gonna go back and fix that too, okay?

1341
00:58:01,649 --> 00:58:04,349
But, first things first, let's make this into a popover.

1342
00:58:04,351 --> 00:58:06,017
So, how do we make this into a popover?

1343
00:58:06,019 --> 00:58:08,286
Well, I'm gonna get rid of this modal segue.

1344
00:58:08,288 --> 00:58:09,520
So here's the modal segue.

1345
00:58:09,522 --> 00:58:11,288
Let me zoom out so you can see it.

1346
00:58:11,290 --> 00:58:14,024
This is the modal segue that segues through this navigation

1347
00:58:14,026 --> 00:58:15,525
controller over to here.

1348
00:58:16,628 --> 00:58:20,662
So I'm just going to delete that by hitting delete.

1349
00:58:20,664 --> 00:58:23,432
I'm gonna have to move these over

1350
00:58:23,434 --> 00:58:25,734
closer because I have such a small screen here.

1351
00:58:25,736 --> 00:58:28,236
Then I'm gonna zoom in and then I'm just gonna make a new

1352
00:58:28,238 --> 00:58:31,272
segue from here directly to here.

1353
00:58:31,274 --> 00:58:33,440
I'm not gonna go through the navigation controller because

1354
00:58:33,442 --> 00:58:34,374
I don't want my popover to

1355
00:58:34,376 --> 00:58:35,875
have a navigation controller title bar.

1356
00:58:35,877 --> 00:58:37,010
Totally unnecessary.

1357
00:58:37,012 --> 00:58:39,578
It's gonna be nice, sleek, little popover.

1358
00:58:39,580 --> 00:58:41,113
So I'm just gonna go directly to here and

1359
00:58:41,115 --> 00:58:42,247
instead of present modally,

1360
00:58:42,249 --> 00:58:45,283
I'm going to do popover presentation here.

1361
00:58:45,285 --> 00:58:47,168
Okay?

1362
00:58:47,169 --> 00:58:49,052
Now when you do a popover, you notice I got an error here.

1363
00:58:49,055 --> 00:58:50,287
Okay?

1364
00:58:50,289 --> 00:58:53,357
If I click on this and see what this error is, it says,

1365
00:58:53,359 --> 00:58:56,093
'Popover segue with no anchor'.

1366
00:58:56,095 --> 00:58:57,327
Okay? I've got some frames to

1367
00:58:57,329 --> 00:58:58,394
adjust here.

1368
00:58:58,396 --> 00:58:59,695
And we have this unreachable scene,

1369
00:58:59,697 --> 00:59:02,197
because of this navigation controller, but that's okay.

1370
00:59:02,199 --> 00:59:04,266
It's this popover error with no anchor.

1371
00:59:04,268 --> 00:59:05,500
So, what does that mean?

1372
00:59:05,502 --> 00:59:08,469
Well, when you do a popover, the little arrow on

1373
00:59:08,471 --> 00:59:11,772
the popover has gotta know where to point, okay?

1374
00:59:11,774 --> 00:59:13,774
Sometimes, it points to a bar button.

1375
00:59:13,776 --> 00:59:16,843
And here, I'm gonna have it point to the map view.

1376
00:59:16,845 --> 00:59:18,395
More specifically,

1377
00:59:18,396 --> 00:59:19,946
I'm gonna have it point to the little pin.

1378
00:59:19,948 --> 00:59:21,748
Okay?

1379
00:59:21,749 --> 00:59:23,549
So if we don't specify that then a popover can't work.

1380
00:59:23,551 --> 00:59:26,435
So how do we specify that?

1381
00:59:26,436 --> 00:59:29,320
How do we specify where, when this popover wants to popover

1382
00:59:29,323 --> 00:59:32,290
from this view controller, it shows up?

1383
00:59:32,292 --> 00:59:34,526
Well, one part of it we can do with dragging.

1384
00:59:34,528 --> 00:59:36,060
You see right here, in the inspector,

1385
00:59:36,062 --> 00:59:39,030
I've inspected this segue right here.

1386
00:59:39,032 --> 00:59:40,431
I clicked right on here.

1387
00:59:40,433 --> 00:59:42,366
You can see that it says anchor.

1388
00:59:42,368 --> 00:59:44,434
It says drag to select an anchor.

1389
00:59:44,436 --> 00:59:48,037
Okay, well, I'm just gonna drag over to my map view,

1390
00:59:48,039 --> 00:59:50,406
oops, except for I need to zoom in.

1391
00:59:50,408 --> 00:59:51,641
Okay? So,

1392
00:59:51,642 --> 00:59:52,875
I'm just going to select the segue.

1393
00:59:52,877 --> 00:59:55,644
I'm gonna drag to my map view.

1394
00:59:55,646 --> 00:59:57,212
And it says, okay, map view.

1395
00:59:57,214 --> 00:59:57,912
Great.

1396
00:59:57,914 --> 00:59:59,147
You're good to go.

1397
00:59:59,148 --> 01:00:00,381
And it game me no more error.

1398
01:00:00,383 --> 01:00:02,516
Except for this is not gonna work either because

1399
01:00:02,518 --> 01:00:06,453
I have to say where in the map view I want this to work from.

1400
01:00:06,455 --> 01:00:08,321
If I don't say where, it's gonna try and

1401
01:00:08,323 --> 01:00:10,390
point it to the edge of the map view itself,

1402
01:00:10,392 --> 01:00:12,658
which is gonna be off screen, which is useless.

1403
01:00:12,660 --> 01:00:14,960
I need to specify a little rectangle inside.

1404
01:00:14,962 --> 01:00:16,194
So how do I do that?

1405
01:00:16,196 --> 01:00:19,064
Where do I specify that little rectangle?

1406
01:00:19,066 --> 01:00:21,766
And the answer is it's exactly where we specify

1407
01:00:21,768 --> 01:00:24,869
anything having to do with configuring a popover.

1408
01:00:24,871 --> 01:00:26,670
Okay and we have already done this in this class but

1409
01:00:26,672 --> 01:00:28,138
you have probably forgotten, but for

1410
01:00:28,140 --> 01:00:30,573
your final project many of you are gonna do popovers.

1411
01:00:30,575 --> 01:00:34,177
So here is something to remember where you

1412
01:00:34,179 --> 01:00:35,478
set things for popover, and

1413
01:00:35,480 --> 01:00:40,282
that is in the prepare for segue for that popover segue.

1414
01:00:40,284 --> 01:00:43,318
Okay, specifically I'm gonna do it right down here, and

1415
01:00:43,320 --> 01:00:47,421
you wanna get the popovers presentation controller.

1416
01:00:47,423 --> 01:00:48,889
Okay? And you get the proper

1417
01:00:48,891 --> 01:00:51,491
presentation controller just by asking the,

1418
01:00:51,493 --> 01:00:55,528
make sure is it the right name for

1419
01:00:55,530 --> 01:00:59,699
these things that I call that PPC, I think I did yeah.

1420
01:00:59,701 --> 01:01:04,336
You just ask the thing that you're presenting,

1421
01:01:04,338 --> 01:01:07,472
give me your popover presentation controller.

1422
01:01:07,474 --> 01:01:10,275
Okay?

1423
01:01:10,276 --> 01:01:13,077
But you probably want to if let this, because you want

1424
01:01:13,079 --> 01:01:15,779
your code to work even if it's not in a popover.

1425
01:01:15,781 --> 01:01:17,647
If we change this back to be modal,

1426
01:01:17,649 --> 01:01:19,349
we'd still want it to work.

1427
01:01:19,351 --> 01:01:21,050
If you're not in a popover presentation this

1428
01:01:21,052 --> 01:01:23,919
will return nil, so you won't be doing the code in here.

1429
01:01:23,921 --> 01:01:26,588
So this code is only going to happen if this segue is

1430
01:01:26,590 --> 01:01:29,124
popover controlled.

1431
01:01:29,126 --> 01:01:32,961
So popover presentation controller, okay, if you look

1432
01:01:32,963 --> 01:01:37,031
at it in the documentation you can see that it's got, oops,

1433
01:01:37,033 --> 01:01:39,933
that's not a very good link to that is it?

1434
01:01:40,936 --> 01:01:42,635
Oh, maybe it doesn't return that.

1435
01:01:44,205 --> 01:01:46,105
Wait a minute. [INAUDIBLE] Okay,

1436
01:01:46,107 --> 01:01:47,305
PopoverPresentationController.

1437
01:01:47,307 --> 01:01:50,241
You can see it's got some things here like that source

1438
01:01:50,243 --> 01:01:51,909
view that we wired up.

1439
01:01:51,911 --> 01:01:54,045
Okay, it's also got sourceRect.

1440
01:01:54,047 --> 01:01:56,413
That's the rectangle inside the source view.

1441
01:01:56,415 --> 01:01:57,748
Or you can have a bar button item.

1442
01:01:57,750 --> 01:02:00,050
If you have a bar button item, you don't need both of these.

1443
01:02:00,052 --> 01:02:02,251
We've, so it's kind of either/or.

1444
01:02:02,253 --> 01:02:05,054
And also, it's got a delegate, which we're gonna use to

1445
01:02:05,056 --> 01:02:08,757
control our adaptive behavior and a few other things.

1446
01:02:08,759 --> 01:02:10,792
But, so that's what you can configure in

1447
01:02:10,794 --> 01:02:12,360
the popoverPresentationController.

1448
01:02:12,362 --> 01:02:14,295
So let's do that sourceRect.

1449
01:02:14,297 --> 01:02:15,563
Okay.

1450
01:02:15,564 --> 01:02:16,830
So the sourceRect equals.

1451
01:02:16,833 --> 01:02:18,732
We want this, basically a rectangle for

1452
01:02:18,734 --> 01:02:22,702
that annotation view so I'm going to say here,

1453
01:02:22,704 --> 01:02:26,406
the sender as an MK annotation view.

1454
01:02:26,408 --> 01:02:30,909
Okay, so sender, remember is this sender to the prepare for

1455
01:02:30,911 --> 01:02:35,880
segue which we passed the annotation view as the sender.

1456
01:02:35,882 --> 01:02:37,665
Okay? So

1457
01:02:37,666 --> 01:02:39,449
the sender is the pin that's causing all this trouble.

1458
01:02:40,553 --> 01:02:44,888
And I added a nice method to that called popover SourceRect

1459
01:02:44,890 --> 01:02:46,189
for coordinate point.

1460
01:02:46,191 --> 01:02:50,426
And you just give it a point, coordinate point.

1461
01:02:50,428 --> 01:02:52,795
And so let's calculate that point.

1462
01:02:52,797 --> 01:02:54,396
I'll show you that method in a second.

1463
01:02:54,398 --> 01:02:56,331
So we're going to let the coordinate point.

1464
01:02:56,333 --> 01:02:59,167
We're going to calculate the coordinate point by getting

1465
01:02:59,169 --> 01:03:01,035
the annotations coordinate and

1466
01:03:01,037 --> 01:03:02,269
using the map view to convert it.

1467
01:03:02,271 --> 01:03:08,475
So map view, convert coordinate,

1468
01:03:08,477 --> 01:03:10,777
and the coordinate is the way points coordinate.

1469
01:03:12,146 --> 01:03:16,148
And we're going to convert it to a point in the map view.

1470
01:03:16,150 --> 01:03:19,117
Alright, so here I'm just getting the point of our pin,

1471
01:03:19,119 --> 01:03:20,719
where our pin is on the map, and

1472
01:03:20,721 --> 01:03:23,388
then I'm asking the notation view, please give me

1473
01:03:23,390 --> 01:03:26,891
a rectangle that would be good for a popover to point at.

1474
01:03:26,893 --> 01:03:28,826
At that coordinate point.

1475
01:03:28,828 --> 01:03:31,928
And this code, this popover thing, is right here.

1476
01:03:31,930 --> 01:03:33,563
And it's really simple, really.

1477
01:03:33,565 --> 01:03:36,466
It just gets the width and height of our frame,

1478
01:03:36,468 --> 01:03:38,100
our little pin views frame.

1479
01:03:38,102 --> 01:03:40,402
And then it offsets it by the calloutOffset and

1480
01:03:40,404 --> 01:03:41,870
the centerOffset.

1481
01:03:41,872 --> 01:03:43,271
Don't worry too much about those.

1482
01:03:43,273 --> 01:03:44,505
But that's all it does.

1483
01:03:44,507 --> 01:03:47,208
So it's basically just putting a frame around itself so

1484
01:03:47,210 --> 01:03:48,642
that we can have the popover.

1485
01:03:48,644 --> 01:03:50,911
I just didn't wanna put that code in here and

1486
01:03:50,913 --> 01:03:53,179
mess it up for you, but that's all it does.

1487
01:03:53,181 --> 01:03:56,549
Now, we have this popover source rec.

1488
01:03:56,551 --> 01:03:57,850
Let's see what this looks like.

1489
01:03:57,852 --> 01:04:00,652
This is not gonna quite be what we want, but

1490
01:04:00,654 --> 01:04:02,254
we're getting there.

1491
01:04:09,996 --> 01:04:15,366
All right, [SOUND] Here we go,' kay?

1492
01:04:15,368 --> 01:04:17,668
I'm gonna long press to drop.

1493
01:04:17,670 --> 01:04:18,535
We're gonna edit it.

1494
01:04:19,904 --> 01:04:20,836
And we got a crash.

1495
01:04:20,838 --> 01:04:23,439
Okay. And, so why does this crash?

1496
01:04:23,441 --> 01:04:26,274
It's because we forgot to set our segue identifier for

1497
01:04:26,276 --> 01:04:28,810
the popover to edit waypoints, okay?

1498
01:04:28,812 --> 01:04:30,111
Probably you've all seen this.

1499
01:04:31,781 --> 01:04:34,248
No segue with identifier error.

1500
01:04:34,250 --> 01:04:35,415
That's easy to fix.

1501
01:04:35,417 --> 01:04:37,484
Let's go back to our storyboard.

1502
01:04:38,453 --> 01:04:41,187
Get our segue inspected.

1503
01:04:41,189 --> 01:04:42,221
And sure enough, look at that.

1504
01:04:42,223 --> 01:04:46,224
Edit Wavepoint.

1505
01:04:46,226 --> 01:04:49,361
All right, sometimes it's good when I forget to do

1506
01:04:49,363 --> 01:04:52,697
things like that because you get to see common things.

1507
01:04:52,699 --> 01:04:54,532
That's a common thing to do, is to forget.

1508
01:04:54,534 --> 01:04:56,400
Either to have the name be different or

1509
01:04:56,402 --> 01:04:58,168
you forget to put it in entirely.

1510
01:05:00,038 --> 01:05:06,575
All right, so now, here we go, like that, and Edit.

1511
01:05:07,545 --> 01:05:08,443
And we've got a popover.

1512
01:05:08,445 --> 01:05:09,961
Whoo!

1513
01:05:09,962 --> 01:05:11,478
It doesn't look very good, though.

1514
01:05:11,481 --> 01:05:14,115
Okay.

1515
01:05:14,116 --> 01:05:16,750
So, it's kind of close, but it's gigantic still, and

1516
01:05:16,753 --> 01:05:18,719
the whole point of this is to not use so

1517
01:05:18,721 --> 01:05:21,054
much darn screen real estate.

1518
01:05:21,056 --> 01:05:22,222
So why is that happening?

1519
01:05:22,224 --> 01:05:25,892
Well, that's because we do nothing to tell the system

1520
01:05:25,894 --> 01:05:28,294
what we would like the content size to be here.

1521
01:05:28,296 --> 01:05:30,629
And if you remember, the last time we did popovers,

1522
01:05:30,631 --> 01:05:32,397
we actually overrode the.

1523
01:05:32,399 --> 01:05:34,699
Property preferred content size and

1524
01:05:34,701 --> 01:05:36,801
return calculated content size.

1525
01:05:36,803 --> 01:05:37,902
Here I'm going to do it a different way.

1526
01:05:37,904 --> 01:05:40,270
I'm gonna actually set the preferred content size.

1527
01:05:40,272 --> 01:05:41,638
So I'm doing the same thing.

1528
01:05:41,639 --> 01:05:43,005
I'm just gonna set it, because it's a var.

1529
01:05:43,008 --> 01:05:44,307
I can set it, it's a settable var.

1530
01:05:44,309 --> 01:05:45,875
I don't have to override it.

1531
01:05:45,877 --> 01:05:48,244
So I'm just gonna set it to a size.

1532
01:05:48,246 --> 01:05:51,447
And so, what kind of size would be good there?

1533
01:05:51,449 --> 01:05:54,116
Let me make some more space.

1534
01:05:54,118 --> 01:05:58,820
We're still doing all this inside this popover-specific

1535
01:05:58,822 --> 01:06:00,555
code.

1536
01:06:00,556 --> 01:06:02,289
A good size for that would be, height-wise,

1537
01:06:02,291 --> 01:06:05,225
it would be if I just let the auto layout do it.

1538
01:06:05,227 --> 01:06:07,060
Wouldn't it be cool if I could just find out what

1539
01:06:07,062 --> 01:06:09,729
the auto layout thought the smallest size was?

1540
01:06:09,731 --> 01:06:10,830
Turns out, you can do that.

1541
01:06:10,832 --> 01:06:15,501
Watch this, let minimum size equal

1542
01:06:15,503 --> 01:06:19,571
the view controller's view.

1543
01:06:19,573 --> 01:06:22,907
I'm just gonna smash down the view controller view as much

1544
01:06:22,909 --> 01:06:24,075
as possible.

1545
01:06:24,077 --> 01:06:25,009
The name of the method is called

1546
01:06:25,011 --> 01:06:28,245
systemLayoutFittingSize.

1547
01:06:28,247 --> 01:06:30,313
And it takes a size, and

1548
01:06:30,315 --> 01:06:32,615
that size is the size it's gonna try to fit into.

1549
01:06:32,617 --> 01:06:34,384
And there's really two choices here.

1550
01:06:34,386 --> 01:06:37,687
One is, fit it into as small a space as possible, or

1551
01:06:37,689 --> 01:06:40,556
fit it into as big a space as possible, okay?

1552
01:06:40,558 --> 01:06:41,957
So I'm gonna go for small as possible,

1553
01:06:41,959 --> 01:06:43,158
cuz I want this thing to be small.

1554
01:06:43,160 --> 01:06:46,361
So that UI layout, fitting size, compress.

1555
01:06:46,363 --> 01:06:48,596
See, there's expanded and compressed.

1556
01:06:48,598 --> 01:06:50,130
So I want the compressed size.

1557
01:06:50,132 --> 01:06:54,334
So this is gonna give me the minimum size that that

1558
01:06:54,336 --> 01:06:56,636
view controller can be by using Auto Layout.

1559
01:06:57,605 --> 01:06:59,104
Okay, which is really awesome.

1560
01:06:59,106 --> 01:07:01,873
This is what the table U cells are using to size,

1561
01:07:01,875 --> 01:07:04,476
get the heights automatically with a layout.

1562
01:07:04,478 --> 01:07:06,445
It's a really, really great feature.

1563
01:07:06,446 --> 01:07:08,413
Now, I don't actually want it to be the minimum size in

1564
01:07:08,415 --> 01:07:09,613
width, though.

1565
01:07:09,615 --> 01:07:11,281
Because I wanna have some room for

1566
01:07:11,283 --> 01:07:14,718
the person to type in the name and the info that they want.

1567
01:07:14,720 --> 01:07:16,353
So I'm going to pick a size.

1568
01:07:16,355 --> 01:07:18,488
It's going to be a constant in my app.

1569
01:07:18,490 --> 01:07:23,258
So, I'm going to set my preferred content size,

1570
01:07:23,260 --> 01:07:24,860
equal BCGSize.

1571
01:07:24,862 --> 01:07:29,163
And the width I want is going to be this constant,

1572
01:07:29,165 --> 01:07:34,234
constants, whoops, width, constants dot, what did I

1573
01:07:34,236 --> 01:07:40,407
call it here, yeah, edit waypoint pop-over width, okay?

1574
01:07:40,409 --> 01:07:42,675
And that the height is gonna be the minimum size.

1575
01:07:42,677 --> 01:07:44,343
The height, okay?

1576
01:07:44,345 --> 01:07:46,311
So I'm using the minimum size for the height, but

1577
01:07:46,313 --> 01:07:50,382
I'm picking this, which I've set to be 320, which

1578
01:07:50,384 --> 01:07:52,917
is pretty standard width, and a pretty good width.

1579
01:07:52,919 --> 01:07:55,453
That's probably about the width of that is now.

1580
01:07:56,556 --> 01:07:58,622
But by setting preferred content size,

1581
01:07:58,624 --> 01:08:01,191
that tells the pop-over machinery

1582
01:08:01,193 --> 01:08:04,361
to make the pop-over be this size if possible.

1583
01:08:04,363 --> 01:08:06,829
It's only preferred, it might not be possible,

1584
01:08:06,831 --> 01:08:09,065
cuz the geometry of other views might get in the way,

1585
01:08:09,067 --> 01:08:10,199
can't do it, but this is,

1586
01:08:10,201 --> 01:08:12,234
it's going to try to make it this if it can't.

1587
01:08:12,236 --> 01:08:13,268
And usually, it can't.

1588
01:08:13,270 --> 01:08:15,403
So, let's go see how this works.

1589
01:08:28,884 --> 01:08:30,250
Okay, here we go.

1590
01:08:30,252 --> 01:08:31,418
Long press.

1591
01:08:31,420 --> 01:08:32,418
Top.

1592
01:08:32,420 --> 01:08:35,538
Edit.

1593
01:08:35,539 --> 01:08:38,657
Oh awesome okay, and now we can edit this right into

1594
01:08:38,659 --> 01:08:43,028
place here, golf course,

1595
01:08:43,030 --> 01:08:46,964
you know, foo.

1596
01:08:46,966 --> 01:08:49,467
Okay, and it's editing it on the fly, editing as do, so

1597
01:08:49,469 --> 01:08:51,035
if I click away and

1598
01:08:51,037 --> 01:08:54,204
then click back, I get golf course still, okay?

1599
01:08:54,206 --> 01:08:56,272
And, again, I can always go back, edit it again.

1600
01:08:57,375 --> 01:08:59,542
So this is really looking good.

1601
01:08:59,544 --> 01:09:01,377
It's not quite perfect.

1602
01:09:01,379 --> 01:09:05,047
It's kind of, if you look at the arrow that points down,

1603
01:09:05,049 --> 01:09:07,215
it looks like it's kind of see-through,

1604
01:09:07,217 --> 01:09:09,283
but the thing is white.

1605
01:09:09,285 --> 01:09:10,951
So, there's no reason that

1606
01:09:10,953 --> 01:09:12,720
this pop-over needs to be white.

1607
01:09:12,722 --> 01:09:14,988
It'd be really cool if it kind of, you could see back,

1608
01:09:14,990 --> 01:09:17,924
see-through it a little bit to what's behind.

1609
01:09:17,926 --> 01:09:22,228
Wouldn't that be kind of more iPhone-ish and kind of iOS-y.

1610
01:09:22,230 --> 01:09:22,961
So let's do that.

1611
01:09:22,963 --> 01:09:24,963
That's trivial to do that.

1612
01:09:24,965 --> 01:09:27,365
Let's just go into our storyboard and

1613
01:09:27,367 --> 01:09:30,768
have our view up here, our little.

1614
01:09:31,837 --> 01:09:34,037
Wavepoint editing view be transparent.

1615
01:09:34,039 --> 01:09:36,506
So I'm just going to select this thing.

1616
01:09:36,508 --> 01:09:38,875
Instead of its background being white right here,

1617
01:09:38,877 --> 01:09:42,745
I'm going to set it to be clear, okay?

1618
01:09:42,747 --> 01:09:44,046
So that's going to fix that.

1619
01:09:44,048 --> 01:09:45,447
So let's go see what that looks like.

1620
01:10:00,129 --> 01:10:05,265
All right, and click Edit, okay?

1621
01:10:05,267 --> 01:10:06,656
So you can see,

1622
01:10:06,657 --> 01:10:08,046
I don't know how well you can see it in that.

1623
01:10:08,047 --> 01:10:09,436
It might be washed out there, but I can, actually, see,

1624
01:10:09,438 --> 01:10:15,274
kind of, a blurred mountains there, scenery behind, okay?

1625
01:10:15,276 --> 01:10:17,209
And it, also, just kinda looks better,

1626
01:10:17,211 --> 01:10:19,811
the text fields stand out a little more.

1627
01:10:19,813 --> 01:10:21,946
It's all, just looks a lot better.

1628
01:10:21,948 --> 01:10:26,083
Okay, now, there's only problem with all of this,

1629
01:10:26,085 --> 01:10:28,352
which is the iPhone.

1630
01:10:28,354 --> 01:10:29,903
Okay?

1631
01:10:29,904 --> 01:10:31,453
Let's see what this looks like on iPhone.

1632
01:10:33,324 --> 01:10:34,724
Here it is.

1633
01:10:34,726 --> 01:10:36,358
Nice. Drop one.

1634
01:10:36,360 --> 01:10:37,726
Ooh, yeah, edit.

1635
01:10:37,728 --> 01:10:39,160
Look, yeah.

1636
01:10:39,162 --> 01:10:40,345
Okay.

1637
01:10:40,346 --> 01:10:41,529
So that looked absolutely terrible.

1638
01:10:41,531 --> 01:10:44,331
We lost our done button because we took it out of that

1639
01:10:44,333 --> 01:10:45,833
navigation controller.

1640
01:10:45,835 --> 01:10:47,868
And it's got this background,

1641
01:10:47,870 --> 01:10:49,969
just black, there's nothing there.

1642
01:10:49,971 --> 01:10:51,804
What's going on here?

1643
01:10:51,805 --> 01:10:53,638
Well, let's try to fix this iPhone thing.

1644
01:10:53,641 --> 01:10:57,376
One thing we can fix is that black.

1645
01:10:57,378 --> 01:10:59,411
The reason that that's coming black,

1646
01:10:59,413 --> 01:11:02,681
is because the default modal presentation style

1647
01:11:02,683 --> 01:11:06,818
is full screen, which means, take over the whole screen.

1648
01:11:06,820 --> 01:11:09,754
And it expects you to draw in the whole screen.

1649
01:11:09,756 --> 01:11:11,555
So it's just leaving that area black,

1650
01:11:11,557 --> 01:11:13,590
it's expecting you're gonna draw in that.

1651
01:11:13,592 --> 01:11:17,027
There's another kind of style which is over full-screen,

1652
01:11:17,029 --> 01:11:21,597
which just means draw on top of whatever is behind.

1653
01:11:21,599 --> 01:11:22,998
So anything that shows through,

1654
01:11:23,000 --> 01:11:24,700
you'll see what's behind.

1655
01:11:24,701 --> 01:11:26,401
And this is what alerts are using, things like that.

1656
01:11:26,403 --> 01:11:29,237
Even the pop-over was using that, it was blurring it, but

1657
01:11:29,239 --> 01:11:30,238
it was still doing that.

1658
01:11:30,240 --> 01:11:32,606
So how do we get that to happen?

1659
01:11:32,608 --> 01:11:33,874
Okay, well, to do that,

1660
01:11:33,876 --> 01:11:36,343
we actually need to use the pop-over's delegate,

1661
01:11:36,345 --> 01:11:37,377
which we did before.

1662
01:11:37,379 --> 01:11:40,046
So I'm going to set the pop-over

1663
01:11:40,048 --> 01:11:44,183
controller's delegate here to be myself, okay?

1664
01:11:44,185 --> 01:11:49,388
That means I need to go up here, and say, that I am a,.

1665
01:11:49,390 --> 01:11:52,790
UI PopoverPresentationController-

1666
01:11:52,792 --> 01:11:54,759
Delegate.

1667
01:11:54,760 --> 01:11:56,727
Be careful here not to say, UIPopover Controller Delegate,

1668
01:11:56,729 --> 01:11:58,429
It's PresentationController.

1669
01:11:58,431 --> 01:11:59,730
That thing is old, okay?

1670
01:11:59,732 --> 01:12:01,564
It's deprecated even.

1671
01:12:01,566 --> 01:12:02,932
So, it's this one you want, the long one,

1672
01:12:02,934 --> 01:12:05,401
PopoverPresentationController- Delegate.

1673
01:12:05,403 --> 01:12:06,869
And once I'm the delegate,

1674
01:12:06,871 --> 01:12:11,439
now I can control that adaptation behavior.

1675
01:12:11,441 --> 01:12:14,042
So why is that thing showing up

1676
01:12:14,044 --> 01:12:16,644
modal like that when we have it to be a popover?

1677
01:12:16,646 --> 01:12:18,045
Okay, we changed it to be a popover,

1678
01:12:18,047 --> 01:12:19,346
why the heck is it showing up modal?

1679
01:12:19,348 --> 01:12:21,614
Well, that's because of this adaptation,

1680
01:12:21,616 --> 01:12:24,417
okay, where the system is adapting to the fact that you

1681
01:12:24,419 --> 01:12:27,787
don't usually show popovers on the phone.

1682
01:12:27,789 --> 01:12:29,121
You show things full-screen modal.

1683
01:12:29,123 --> 01:12:30,288
So it's adapting.

1684
01:12:30,290 --> 01:12:32,724
So now that we're the delegate, let's go ahead and

1685
01:12:32,726 --> 01:12:35,126
implement the adaptive presentations style for

1686
01:12:35,128 --> 01:12:37,695
presentation controller, delegate method.

1687
01:12:37,697 --> 01:12:40,297
Thank God for escape completion there.

1688
01:12:40,299 --> 01:12:43,166
And all we need to do here is return the style, so

1689
01:12:43,168 --> 01:12:46,169
the modal presentation style I'm gonna return,

1690
01:12:46,171 --> 01:12:49,105
instead of fullscreen, is, overFullscreen.

1691
01:12:49,107 --> 01:12:55,144
Oops, not over [INAUDIBLE] overFullscreen.

1692
01:12:55,146 --> 01:12:59,014
Okay, so let's see what that did.

1693
01:12:59,016 --> 01:13:01,149
It's going to make it a little better, not a lot better,

1694
01:13:01,151 --> 01:13:02,283
but a little better, okay?

1695
01:13:03,453 --> 01:13:04,451
Here we go. Now,

1696
01:13:04,453 --> 01:13:07,621
at least we don't have the black, okay?

1697
01:13:07,623 --> 01:13:10,990
So we can see through, still not so hot.

1698
01:13:12,093 --> 01:13:14,093
We need that done button back for one thing,

1699
01:13:14,095 --> 01:13:16,428
without that done button we're done, okay?

1700
01:13:16,430 --> 01:13:17,929
So let's get that done button back.

1701
01:13:17,931 --> 01:13:21,232
And I'm going to do that by implementing another pop over

1702
01:13:21,234 --> 01:13:24,835
delegate method here which is called, I don't remember what

1703
01:13:24,837 --> 01:13:27,904
the thing is even called, oh yes, presentation.

1704
01:13:29,541 --> 01:13:31,841
It's this one right here,

1705
01:13:31,843 --> 01:13:36,245
viewControllerForAdapterPrese- ntationStyle, okay?

1706
01:13:36,247 --> 01:13:39,881
So this one right here is saying give me a view

1707
01:13:39,883 --> 01:13:46,254
controller to display this thing when I adapt, okay?

1708
01:13:46,256 --> 01:13:47,588
So what I'm going to do is,

1709
01:13:47,590 --> 01:13:50,391
I'm going to give it a navigation controller, and

1710
01:13:50,393 --> 01:13:51,825
tell it to use that instead.

1711
01:13:51,827 --> 01:13:56,129
So I'm just gonna say return UINavigationController.

1712
01:13:56,131 --> 01:13:58,531
The root view of the navigation controller wants to

1713
01:13:58,533 --> 01:14:01,600
be the thing I'm presenting, which I can get from

1714
01:14:01,602 --> 01:14:04,670
this presentation controller argument that's passed to me.

1715
01:14:04,672 --> 01:14:08,039
That's just controller.presentedViewContr-

1716
01:14:08,041 --> 01:14:08,639
oller.

1717
01:14:08,641 --> 01:14:12,876
ViewController, okay?

1718
01:14:12,878 --> 01:14:14,310
So that's it.

1719
01:14:14,312 --> 01:14:20,883
So let's see what happens now.

1720
01:14:20,885 --> 01:14:24,219
All right, we're here, we go here, we go here,

1721
01:14:24,221 --> 01:14:26,071
oh much better.

1722
01:14:26,072 --> 01:14:27,922
Now we have done, it still kind of looks terrible, but

1723
01:14:27,925 --> 01:14:29,641
we have done.

1724
01:14:29,642 --> 01:14:31,358
So we can say done, oh, excellent, okay.

1725
01:14:31,361 --> 01:14:34,762
So now, what are we gonna do to fix this see-through thing?

1726
01:14:34,764 --> 01:14:37,465
Well, I could just make it white again,

1727
01:14:37,467 --> 01:14:40,901
because now I'm returning the thing here, that view for

1728
01:14:40,903 --> 01:14:42,235
controller for adapter present thing.

1729
01:14:42,237 --> 01:14:44,004
I'm returning the whole thing, I can do anything I want.

1730
01:14:44,006 --> 01:14:45,738
But what I'm gonna use this to take advantage of is use

1731
01:14:45,740 --> 01:14:49,141
this chance to show you visual effects like blur.

1732
01:14:49,143 --> 01:14:51,710
Because we want really the same thing we had on the iPad,

1733
01:14:51,712 --> 01:14:54,980
where the pop-over comes up and it's kind of, you can see

1734
01:14:54,982 --> 01:14:56,715
the background through, but it's a little blurred.

1735
01:14:56,717 --> 01:14:59,017
We're going to do the same thing here, okay?

1736
01:14:59,019 --> 01:15:01,419
It's going to come up, it's going to be white, but

1737
01:15:01,421 --> 01:15:03,854
a little blur we can see what's in the background.

1738
01:15:04,990 --> 01:15:06,856
So how do we do that?

1739
01:15:06,858 --> 01:15:08,691
To do that, we, okay,

1740
01:15:08,693 --> 01:15:12,028
the way the visual effects work is very simple.

1741
01:15:12,030 --> 01:15:14,863
It's just a view, okay, a visual effect view,

1742
01:15:14,865 --> 01:15:19,434
and that view looks what's behinds it, what's behind it,

1743
01:15:19,436 --> 01:15:23,104
looks at what is behind it, and blurs it, and

1744
01:15:23,106 --> 01:15:25,739
then draws that as itself.

1745
01:15:25,741 --> 01:15:27,941
It's as simple as that, okay?

1746
01:15:27,943 --> 01:15:31,344
It's just, looks what behind you in the view hierarchy,

1747
01:15:31,346 --> 01:15:34,047
even if that's other views, or I don't care what it is,

1748
01:15:34,049 --> 01:15:37,983
it looks at it, creates white or even a dark color and

1749
01:15:37,985 --> 01:15:40,586
then blurs it, and now that's what it draws.

1750
01:15:40,588 --> 01:15:43,221
So all we need to do to make this blur happen is

1751
01:15:43,223 --> 01:15:47,058
put a visual effects view right at the top

1752
01:15:47,060 --> 01:15:50,228
of the navigation controller's view hierarchy

1753
01:15:50,230 --> 01:15:52,430
behind everything that it draws.

1754
01:15:52,432 --> 01:15:53,664
Okay, right at the top.

1755
01:15:53,666 --> 01:15:55,265
And we know how to insert something at the top of

1756
01:15:55,267 --> 01:15:56,466
the view hierarchy, right?

1757
01:15:56,468 --> 01:15:59,769
We just put it at index zero in the subviews list.

1758
01:15:59,771 --> 01:16:01,937
It'll be right in the back.

1759
01:16:01,939 --> 01:16:03,639
Okay, and everything else will be in front.

1760
01:16:03,641 --> 01:16:05,474
Now, if I put it right in the back of the navigation

1761
01:16:05,476 --> 01:16:08,309
control, the thing that's behind the visual effect view

1762
01:16:08,311 --> 01:16:10,311
is gonna be that map view.

1763
01:16:10,313 --> 01:16:11,779
Because it's clear and so,

1764
01:16:11,781 --> 01:16:13,681
we look back and whoa, there's map view there.

1765
01:16:13,683 --> 01:16:16,483
So it's gonna blur that, that's exactly what we want.

1766
01:16:16,485 --> 01:16:21,354
All right, so to do this we just need to say I'm gonna

1767
01:16:21,356 --> 01:16:24,156
let nav con equal this.

1768
01:16:25,459 --> 01:16:27,692
Okay, so there's your navigation controller.

1769
01:16:27,694 --> 01:16:32,596
And then I'm gonna say let a visualEffectView equal

1770
01:16:32,598 --> 01:16:34,898
UIVisualEffectView.

1771
01:16:34,900 --> 01:16:38,001
Okay, that's this view that does what I was talking about.

1772
01:16:38,003 --> 01:16:40,070
And it wants to know what effect you wanna apply.

1773
01:16:40,072 --> 01:16:43,839
There's a couple of effects, vibrancy and blur.

1774
01:16:43,841 --> 01:16:45,207
So we're gonna do blur.

1775
01:16:45,209 --> 01:16:46,708
So I want the blur effect.

1776
01:16:48,445 --> 01:16:53,114
And the blur effect I want is with style, extra light.

1777
01:16:53,116 --> 01:16:56,483
So, extra light is a very light colored thing,

1778
01:16:56,485 --> 01:16:58,285
almost white, with the blur in there.

1779
01:16:58,287 --> 01:17:01,888
There's also dark and just light.

1780
01:17:01,890 --> 01:17:05,525
Then I'm going to set the visual effect views frame

1781
01:17:05,527 --> 01:17:09,362
equal to the navCon's view.bounds.

1782
01:17:09,364 --> 01:17:13,899
So I want to totally fill the top level of the navigation

1783
01:17:13,901 --> 01:17:15,133
controller.

1784
01:17:15,135 --> 01:17:18,302
And then I'm just going to add this

1785
01:17:18,304 --> 01:17:21,872
thing to the view hierarchy of my navigation controller.

1786
01:17:21,874 --> 01:17:26,743
VisualEffectView, and I'm gonna put it at index zero.

1787
01:17:26,745 --> 01:17:29,612
Okay which means it's in the back of absolutely everything.

1788
01:17:29,614 --> 01:17:31,947
And then I'm going to return the navigation controller.

1789
01:17:34,685 --> 01:17:40,355
Okay, here we go, all right.

1790
01:17:40,357 --> 01:17:41,289
Click.

1791
01:17:41,291 --> 01:17:42,223
Boom.

1792
01:17:42,225 --> 01:17:43,357
Edit.

1793
01:17:43,359 --> 01:17:43,957
Blur.

1794
01:17:45,327 --> 01:17:46,860
So this looks pretty good.

1795
01:17:46,861 --> 01:17:48,394
This actually looks slightly better than being all white,

1796
01:17:48,396 --> 01:17:51,330
it kind of gives users a little bit of context to where

1797
01:17:51,332 --> 01:17:52,598
they were.

1798
01:17:52,600 --> 01:17:54,266
Still works perfectly fine here.

1799
01:17:54,268 --> 01:18:01,606
Our favorite golf course, it's under the snow, okay?

1800
01:18:01,608 --> 01:18:04,508
Hit done, go here.

1801
01:18:04,510 --> 01:18:05,743
It's working.

1802
01:18:05,745 --> 01:18:08,211
And just to make sure that we didn't break anything on

1803
01:18:08,213 --> 01:18:10,847
the iPad, let's go run it over there one more time.

1804
01:18:12,150 --> 01:18:13,849
Now, we can't possibly have broken anything here,

1805
01:18:13,851 --> 01:18:15,951
because, famous last words, but [LAUGH] we can't,

1806
01:18:15,953 --> 01:18:19,187
because all we changed was the adaptive stuff.

1807
01:18:19,189 --> 01:18:20,789
And on the iPad, it doesn't adapt,

1808
01:18:20,791 --> 01:18:23,324
because the iPad is regular in both width and

1809
01:18:23,326 --> 01:18:28,162
height, it never has to adapt to being in a compact space.

1810
01:18:28,164 --> 01:18:29,329
So here we go.

1811
01:18:29,331 --> 01:18:29,963
Click on here.

1812
01:18:31,433 --> 01:18:32,598
Bingo.

1813
01:18:32,600 --> 01:18:34,400
Okay, so that's it.

1814
01:18:34,402 --> 01:18:35,400
Perfect timing.

1815
01:18:35,402 --> 01:18:36,801
Almost.

1816
01:18:36,803 --> 01:18:39,537
Next time, we will pick up with slides that tell you how

1817
01:18:39,539 --> 01:18:41,606
to do the camera.

1818
01:18:41,607 --> 01:18:43,674
And then we'll enhance our editor here to let you take

1819
01:18:43,676 --> 01:18:45,176
a picture.

1820
01:18:45,177 --> 01:18:46,677
And we'll enhance our popover right here,

1821
01:18:46,679 --> 01:18:48,979
to show the picture right in the pop-over, okay?

1822
01:18:48,981 --> 01:18:50,647
And then after that we'll talk a little bit about

1823
01:18:50,649 --> 01:18:53,850
persistence, and we'll save the image in the file system.

1824
01:18:53,852 --> 01:18:55,184
Show you how to do that.

1825
01:18:55,186 --> 01:18:56,752
Okay, thank you very much.

1826
01:18:56,754 --> 01:18:58,520
I'm here if you have any questions as usual.

1827
01:19:00,023 --> 01:19:00,054
>> For more, please visit us at stanford.edu.
